!function(){var t,e,n={0:function(t,e,n){"use strict";n.d(e,{p:function(){return o},r:function(){return i}});var r=n(608),o=function(){function t(){this.metrics=[]}return t.prototype.increment=function(t,e,n){void 0===e&&(e=1),this.metrics.push({metric:t,value:e,tags:null!=n?n:[],type:"counter",timestamp:Date.now()})},t.prototype.gauge=function(t,e,n){this.metrics.push({metric:t,value:e,tags:null!=n?n:[],type:"gauge",timestamp:Date.now()})},t.prototype.flush=function(){var t=this.metrics.map(function(t){return(0,r.Cl)((0,r.Cl)({},t),{tags:t.tags.join(",")})});console.table?console.table(t):console.log(t),this.metrics=[]},t.prototype.serialize=function(){return this.metrics.map(function(t){return{m:t.metric,v:t.value,t:t.tags,k:(e=t.type,{gauge:"g",counter:"c"}[e]),e:t.timestamp};var e})},t}(),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,r.C6)(e,t),e.prototype.gauge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.increment=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.flush=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.serialize=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return[]},e}(o)},16:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Screen=void 0;var o=r(n(896)),i=n(643),u=n(497);function a(t,e){i.Page.call(this,t,e)}e.Screen=a,o.default(a,i.Page),a.prototype.action=function(){return"screen"},a.prototype.type=a.prototype.action,a.prototype.event=function(t){return t?"Viewed "+t+" Screen":"Loaded a Screen"},a.prototype.track=function(t){var e=this.json();return e.event=this.event(t),e.timestamp=this.timestamp(),e.properties=this.properties(),new u.Track(e,this.opts)}},33:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=/.+\@.+\..+/;e.default=function(t){return n.test(t)}},84:function(t,e){"use strict";var n=/^(\d{4})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:([ T])(\d{2}):?(\d{2})(?::?(\d{2})(?:[,\.](\d{1,}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/;e.parse=function(t){var e=[1,5,6,7,11,12],r=n.exec(t),o=0;if(!r)return new Date(t);for(var i,u=0;i=e[u];u++)r[i]=parseInt(r[i],10)||0;r[2]=parseInt(r[2],10)||1,r[3]=parseInt(r[3],10)||1,r[2]--,r[8]=r[8]?(r[8]+"00").substring(0,3):0," "===r[4]?o=(new Date).getTimezoneOffset():"Z"!==r[9]&&r[10]&&(o=60*r[11]+r[12],"+"===r[10]&&(o=0-o));var a=Date.UTC(r[1],r[2],r[3],r[5],r[6]+o,r[7],r[8]);return new Date(a)},e.is=function(t,e){return"string"==typeof t&&((!e||!1!==/^\d{4}-\d{2}-\d{2}/.test(t))&&n.test(t))}},178:function(t,e){"use strict";var n=/\d{13}/;e.is=function(t){return n.test(t)},e.parse=function(t){return t=parseInt(t,10),new Date(t)}},190:function(t,e,n){"use strict";function r(t,e){return new Promise(function(n,r){var o=setTimeout(function(){r(Error("Promise timed out"))},e);t.then(function(t){return clearTimeout(o),n(t)}).catch(r)})}function o(t,e,n){var o;return(o=n,new Promise(function(t){return setTimeout(t,o)})).then(function(){return r(function(){try{return Promise.resolve(e(t))}catch(t){return Promise.reject(t)}}(),1e3)}).catch(function(e){null==t||t.log("warn","Callback Error",{error:e}),null==t||t.stats.increment("callback_error")}).then(function(){return t})}n.d(e,{s2:function(){return r},w_:function(){return o}})},390:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Delete=e.Screen=e.Page=e.Track=e.Identify=e.Group=e.Alias=e.Facade=void 0;var o=n(726);Object.defineProperty(e,"Facade",{enumerable:!0,get:function(){return o.Facade}});var i=n(658);Object.defineProperty(e,"Alias",{enumerable:!0,get:function(){return i.Alias}});var u=n(473);Object.defineProperty(e,"Group",{enumerable:!0,get:function(){return u.Group}});var a=n(588);Object.defineProperty(e,"Identify",{enumerable:!0,get:function(){return a.Identify}});var s=n(497);Object.defineProperty(e,"Track",{enumerable:!0,get:function(){return s.Track}});var c=n(643);Object.defineProperty(e,"Page",{enumerable:!0,get:function(){return c.Page}});var l=n(16);Object.defineProperty(e,"Screen",{enumerable:!0,get:function(){return l.Screen}});var f=n(555);Object.defineProperty(e,"Delete",{enumerable:!0,get:function(){return f.Delete}}),e.default=r(r({},o.Facade),{Alias:i.Alias,Group:u.Group,Identify:a.Identify,Track:s.Track,Page:c.Page,Screen:l.Screen,Delete:f.Delete})},435:function(t,e,n){"use strict";function r(t,e,n){e.split&&(e=e.split("."));for(var r,o,i=0,u=e.length,a=t;i<u&&"__proto__"!=(o=""+e[i++])&&"constructor"!==o&&"prototype"!==o;)a=a[o]=i===u?n:typeof(r=a[o])==typeof e?r:0*e[i]!=0||~(""+e[i]).indexOf(".")?{}:[]}n.d(e,{J:function(){return r}})},473:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Group=void 0;var o=r(n(896)),i=r(n(33)),u=r(n(510)),a=n(726);function s(t,e){a.Facade.call(this,t,e)}e.Group=s,o.default(s,a.Facade);var c=s.prototype;c.action=function(){return"group"},c.type=c.action,c.groupId=a.Facade.field("groupId"),c.created=function(){var t=this.proxy("traits.createdAt")||this.proxy("traits.created")||this.proxy("properties.createdAt")||this.proxy("properties.created");if(t)return u.default(t)},c.email=function(){var t=this.proxy("traits.email");if(t)return t;var e=this.groupId();return i.default(e)?e:void 0},c.traits=function(t){var e=this.properties(),n=this.groupId();for(var r in t=t||{},n&&(e.id=n),t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=null==this[r]?this.proxy("traits."+r):this[r]();if(null==o)continue;e[t[r]]=o,delete e[r]}return e},c.name=a.Facade.proxy("traits.name"),c.industry=a.Facade.proxy("traits.industry"),c.employees=a.Facade.proxy("traits.employees"),c.properties=function(){return this.field("traits")||this.field("properties")||{}}},497:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Track=void 0;var o=r(n(896)),i=n(726),u=n(588),a=r(n(33)),s=r(n(735));function c(t,e){i.Facade.call(this,t,e)}e.Track=c,o.default(c,i.Facade);var l=c.prototype;l.action=function(){return"track"},l.type=l.action,l.event=i.Facade.field("event"),l.value=i.Facade.proxy("properties.value"),l.category=i.Facade.proxy("properties.category"),l.id=i.Facade.proxy("properties.id"),l.productId=function(){return this.proxy("properties.product_id")||this.proxy("properties.productId")},l.promotionId=function(){return this.proxy("properties.promotion_id")||this.proxy("properties.promotionId")},l.cartId=function(){return this.proxy("properties.cart_id")||this.proxy("properties.cartId")},l.checkoutId=function(){return this.proxy("properties.checkout_id")||this.proxy("properties.checkoutId")},l.paymentId=function(){return this.proxy("properties.payment_id")||this.proxy("properties.paymentId")},l.couponId=function(){return this.proxy("properties.coupon_id")||this.proxy("properties.couponId")},l.wishlistId=function(){return this.proxy("properties.wishlist_id")||this.proxy("properties.wishlistId")},l.reviewId=function(){return this.proxy("properties.review_id")||this.proxy("properties.reviewId")},l.orderId=function(){return this.proxy("properties.id")||this.proxy("properties.order_id")||this.proxy("properties.orderId")},l.sku=i.Facade.proxy("properties.sku"),l.tax=i.Facade.proxy("properties.tax"),l.name=i.Facade.proxy("properties.name"),l.price=i.Facade.proxy("properties.price"),l.total=i.Facade.proxy("properties.total"),l.repeat=i.Facade.proxy("properties.repeat"),l.coupon=i.Facade.proxy("properties.coupon"),l.shipping=i.Facade.proxy("properties.shipping"),l.discount=i.Facade.proxy("properties.discount"),l.shippingMethod=function(){return this.proxy("properties.shipping_method")||this.proxy("properties.shippingMethod")},l.paymentMethod=function(){return this.proxy("properties.payment_method")||this.proxy("properties.paymentMethod")},l.description=i.Facade.proxy("properties.description"),l.plan=i.Facade.proxy("properties.plan"),l.subtotal=function(){var t=s.default(this.properties(),"subtotal"),e=this.total()||this.revenue();if(t)return t;if(!e)return 0;if(this.total()){var n=this.tax();n&&(e-=n),(n=this.shipping())&&(e-=n),(n=this.discount())&&(e+=n)}return e},l.products=function(){var t=this.properties(),e=s.default(t,"products");return Array.isArray(e)?e.filter(function(t){return null!==t}):[]},l.quantity=function(){return(this.obj.properties||{}).quantity||1},l.currency=function(){return(this.obj.properties||{}).currency||"USD"},l.referrer=function(){return this.proxy("context.referrer.url")||this.proxy("context.page.referrer")||this.proxy("properties.referrer")},l.query=i.Facade.proxy("options.query"),l.properties=function(t){var e=this.field("properties")||{};for(var n in t=t||{})if(Object.prototype.hasOwnProperty.call(t,n)){var r=null==this[n]?this.proxy("properties."+n):this[n]();if(null==r)continue;e[t[n]]=r,delete e[n]}return e},l.username=function(){return this.proxy("traits.username")||this.proxy("properties.username")||this.userId()||this.sessionId()},l.email=function(){var t=this.proxy("traits.email")||this.proxy("properties.email")||this.proxy("options.traits.email");if(t)return t;var e=this.userId();return a.default(e)?e:void 0},l.revenue=function(){var t=this.proxy("properties.revenue"),e=this.event();return!t&&e&&e.match(/^[ _]?completed[ _]?order[ _]?|^[ _]?order[ _]?completed[ _]?$/i)&&(t=this.proxy("properties.total")),function(t){if(!t)return;if("number"==typeof t)return t;if("string"!=typeof t)return;if(t=t.replace(/\$/g,""),t=parseFloat(t),!isNaN(t))return t}(t)},l.cents=function(){var t=this.revenue();return"number"!=typeof t?this.value()||0:100*t},l.identify=function(){var t=this.json();return t.traits=this.traits(),new u.Identify(t,this.opts)}},500:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={Salesforce:!0};e.default=function(t){return!n[t]}},510:function(t,e,n){"use strict";var r=n(84),o=n(178),i=n(955),u=Object.prototype.toString;t.exports=function(t){return e=t,"[object Date]"===u.call(e)?t:function(t){return"[object Number]"===u.call(t)}(t)?new Date((n=t)<315576e5?1e3*n:n):r.is(t)?r.parse(t):o.is(t)?o.parse(t):i.is(t)?i.parse(t):new Date(t);var e,n}},525:function(t,e,n){"use strict";n.d(e,{W:function(){return o}});var r=n(390);function o(t,e){var n=new r.Facade(t,e);return"track"===t.type&&(n=new r.Track(t,e)),"identify"===t.type&&(n=new r.Identify(t,e)),"page"===t.type&&(n=new r.Page(t,e)),"alias"===t.type&&(n=new r.Alias(t,e)),"group"===t.type&&(n=new r.Group(t,e)),"screen"===t.type&&(n=new r.Screen(t,e)),Object.defineProperty(n,"obj",{value:t,writable:!0}),n}},555:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Delete=void 0;var o=r(n(896)),i=n(726);function u(t,e){i.Facade.call(this,t,e)}e.Delete=u,o.default(u,i.Facade),u.prototype.type=function(){return"delete"}},588:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Identify=void 0;var o=n(726),i=r(n(735)),u=r(n(896)),a=r(n(33)),s=r(n(510)),c=function(t){return t.trim()};function l(t,e){o.Facade.call(this,t,e)}e.Identify=l,u.default(l,o.Facade);var f=l.prototype;f.action=function(){return"identify"},f.type=f.action,f.traits=function(t){var e=this.field("traits")||{},n=this.userId();for(var r in t=t||{},n&&(e.id=n),t){var o=null==this[r]?this.proxy("traits."+r):this[r]();null!=o&&(e[t[r]]=o,r!==t[r]&&delete e[r])}return e},f.email=function(){var t=this.proxy("traits.email");if(t)return t;var e=this.userId();return a.default(e)?e:void 0},f.created=function(){var t=this.proxy("traits.created")||this.proxy("traits.createdAt");if(t)return s.default(t)},f.companyCreated=function(){var t=this.proxy("traits.company.created")||this.proxy("traits.company.createdAt");if(t)return s.default(t)},f.companyName=function(){return this.proxy("traits.company.name")},f.name=function(){var t=this.proxy("traits.name");if("string"==typeof t)return c(t);var e=this.firstName(),n=this.lastName();return e&&n?c(e+" "+n):void 0},f.firstName=function(){var t=this.proxy("traits.firstName");if("string"==typeof t)return c(t);var e=this.proxy("traits.name");return"string"==typeof e?c(e).split(" ")[0]:void 0},f.lastName=function(){var t=this.proxy("traits.lastName");if("string"==typeof t)return c(t);var e=this.proxy("traits.name");if("string"==typeof e){var n=c(e).indexOf(" ");if(-1!==n)return c(e.substr(n+1))}},f.uid=function(){return this.userId()||this.username()||this.email()},f.description=function(){return this.proxy("traits.description")||this.proxy("traits.background")},f.age=function(){var t=this.birthday(),e=i.default(this.traits(),"age");return null!=e?e:t instanceof Date?(new Date).getFullYear()-t.getFullYear():void 0},f.avatar=function(){var t=this.traits();return i.default(t,"avatar")||i.default(t,"photoUrl")||i.default(t,"avatarUrl")},f.position=function(){var t=this.traits();return i.default(t,"position")||i.default(t,"jobTitle")},f.username=o.Facade.proxy("traits.username"),f.website=o.Facade.one("traits.website"),f.websites=o.Facade.multi("traits.website"),f.phone=o.Facade.one("traits.phone"),f.phones=o.Facade.multi("traits.phone"),f.address=o.Facade.proxy("traits.address"),f.gender=o.Facade.proxy("traits.gender"),f.birthday=o.Facade.proxy("traits.birthday")},589:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=n(84);function i(t,e){return void 0===e&&(e=!0),t&&"object"===r(t)?function(t,e){return Object.keys(t).forEach(function(n){t[n]=i(t[n],e)}),t}(t,e):Array.isArray(t)?function(t,e){return t.forEach(function(n,r){t[r]=i(n,e)}),t}(t,e):o.is(t,e)?o.parse(t):t}t.exports=i},608:function(t,e,n){"use strict";n.d(e,{C6:function(){return o},Cl:function(){return i},Tt:function(){return u},YH:function(){return s},fX:function(){return c},sH:function(){return a}});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var i=function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};function u(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}function a(t,e,n,r){return new(n||(n=Promise))(function(o,i){function u(t){try{s(r.next(t))}catch(t){i(t)}}function a(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(u,a)}s((r=r.apply(t,e||[])).next())})}function s(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},u=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return u.next=a(0),u.throw=a(1),u.return=a(2),"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}Object.create;function c(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}Object.create;"function"==typeof SuppressedError&&SuppressedError},643:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Page=void 0;var o=r(n(896)),i=n(726),u=n(497),a=r(n(33));function s(t,e){i.Facade.call(this,t,e)}e.Page=s,o.default(s,i.Facade);var c=s.prototype;c.action=function(){return"page"},c.type=c.action,c.category=i.Facade.field("category"),c.name=i.Facade.field("name"),c.title=i.Facade.proxy("properties.title"),c.path=i.Facade.proxy("properties.path"),c.url=i.Facade.proxy("properties.url"),c.referrer=function(){return this.proxy("context.referrer.url")||this.proxy("context.page.referrer")||this.proxy("properties.referrer")},c.properties=function(t){var e=this.field("properties")||{},n=this.category(),r=this.name();for(var o in t=t||{},n&&(e.category=n),r&&(e.name=r),t)if(Object.prototype.hasOwnProperty.call(t,o)){var i=null==this[o]?this.proxy("properties."+o):this[o]();if(null==i)continue;e[t[o]]=i,o!==t[o]&&delete e[o]}return e},c.email=function(){var t=this.proxy("context.traits.email")||this.proxy("properties.email");if(t)return t;var e=this.userId();return a.default(e)?e:void 0},c.fullName=function(){var t=this.category(),e=this.name();return e&&t?t+" "+e:e},c.event=function(t){return t?"Viewed "+t+" Page":"Loaded a Page"},c.track=function(t){var e=this.json();return e.event=this.event(t),e.timestamp=this.timestamp(),e.properties=this.properties(),new u.Track(e,this.opts)}},658:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Alias=void 0;var o=r(n(896)),i=n(726);function u(t,e){i.Facade.call(this,t,e)}e.Alias=u,o.default(u,i.Facade),u.prototype.action=function(){return"alias"},u.prototype.type=u.prototype.action,u.prototype.previousId=function(){return this.field("previousId")||this.field("from")},u.prototype.from=u.prototype.previousId,u.prototype.userId=function(){return this.field("userId")||this.field("to")},u.prototype.to=u.prototype.userId},659:function(t,e,n){"use strict";n.d(e,{v4:function(){return u}});for(var r,o=256,i=[];o--;)i[o]=(o+256).toString(16).substring(1);function u(){var t,e=0,n="";if(!r||o+16>256){for(r=Array(e=256);e--;)r[e]=256*Math.random()|0;e=o=0}for(;e<16;e++)t=r[o+e],n+=6==e?i[15&t|64]:8==e?i[63&t|128]:i[t],1&e&&e>1&&e<11&&(n+="-");return o++,n}},726:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Facade=void 0;var i=o(n(822)),u=n(827),a=o(n(500)),s=o(n(510)),c=o(n(735)),l=o(n(589));function f(t,e){e=e||{},this.raw=u.clone(t),"clone"in e||(e.clone=!0),e.clone&&(t=u.clone(t)),"traverse"in e||(e.traverse=!0),t.timestamp="timestamp"in t?s.default(t.timestamp):new Date,e.traverse&&l.default(t),this.opts=e,this.obj=t}e.Facade=f;var p=f.prototype;function d(t){return u.clone(t)}p.proxy=function(t){var e=t.split("."),n=this[t=e.shift()]||this.obj[t];return n?("function"==typeof n&&(n=n.call(this)||{}),0===e.length||(n=c.default(n,e.join("."))),this.opts.clone?d(n):n):n},p.field=function(t){var e=this.obj[t];return this.opts.clone?d(e):e},f.proxy=function(t){return function(){return this.proxy(t)}},f.field=function(t){return function(){return this.field(t)}},f.multi=function(t){return function(){var e=this.proxy(t+"s");if(Array.isArray(e))return e;var n=this.proxy(t);return n&&(n=[this.opts.clone?u.clone(n):n]),n||[]}},f.one=function(t){return function(){var e=this.proxy(t);if(e)return e;var n=this.proxy(t+"s");return Array.isArray(n)?n[0]:void 0}},p.json=function(){var t=this.opts.clone?u.clone(this.obj):this.obj;return this.type&&(t.type=this.type()),t},p.rawEvent=function(){return this.raw},p.options=function(t){var e=this.obj.options||this.obj.context||{},n=this.opts.clone?u.clone(e):e;if(!t)return n;if(this.enabled(t)){var o=this.integrations(),i=o[t]||c.default(o,t);return"object"!==r(i)&&(i=c.default(this.options(),t)),"object"===r(i)?i:{}}},p.context=p.options,p.enabled=function(t){var e=this.proxy("options.providers.all");"boolean"!=typeof e&&(e=this.proxy("options.all")),"boolean"!=typeof e&&(e=this.proxy("integrations.all")),"boolean"!=typeof e&&(e=!0);var n=e&&a.default(t),r=this.integrations();if(r.providers&&r.providers.hasOwnProperty(t)&&(n=r.providers[t]),r.hasOwnProperty(t)){var o=r[t];n="boolean"!=typeof o||o}return!!n},p.integrations=function(){return this.obj.integrations||this.proxy("options.providers")||this.options()},p.active=function(){var t=this.proxy("options.active");return null==t&&(t=!0),t},p.anonymousId=function(){return this.field("anonymousId")||this.field("sessionId")},p.sessionId=p.anonymousId,p.groupId=f.proxy("options.groupId"),p.traits=function(t){var e=this.proxy("options.traits")||{},n=this.userId();for(var r in t=t||{},n&&(e.id=n),t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=null==this[r]?this.proxy("options.traits."+r):this[r]();if(null==o)continue;e[t[r]]=o,delete e[r]}return e},p.library=function(){var t=this.proxy("options.library");return t?"string"==typeof t?{name:t,version:null}:t:{name:"unknown",version:null}},p.device=function(){var t=this.proxy("context.device");"object"===r(t)&&null!==t||(t={});var e=this.library().name;return t.type||(e.indexOf("ios")>-1&&(t.type="ios"),e.indexOf("android")>-1&&(t.type="android")),t},p.userAgent=f.proxy("context.userAgent"),p.timezone=f.proxy("context.timezone"),p.timestamp=f.field("timestamp"),p.channel=f.field("channel"),p.ip=f.proxy("context.ip"),p.userId=f.field("userId"),i.default(p)},735:function(t){function e(t){return function(e,n,r,i){var u,a=i&&function(t){return"function"==typeof t}(i.normalizer)?i.normalizer:o;n=a(n);for(var s=!1;!s;)c();function c(){for(u in e){var t=a(u);if(0===n.indexOf(t)){var r=n.substr(t.length);if("."===r.charAt(0)||0===r.length){n=r.substr(1);var o=e[u];return null==o?void(s=!0):n.length?void(e=o):void(s=!0)}}}u=void 0,s=!0}if(u)return null==e?e:t(e,u,r)}}function n(t,e){return t.hasOwnProperty(e)&&delete t[e],t}function r(t,e,n){return t.hasOwnProperty(e)&&(t[e]=n),t}function o(t){return t.replace(/[^a-zA-Z0-9\.]+/g,"").toLowerCase()}t.exports=e(function(t,e){if(t.hasOwnProperty(e))return t[e]}),t.exports.find=t.exports,t.exports.replace=function(t,n,o,i){return e(r).call(this,t,n,o,i),t},t.exports.del=function(t,r,o){return e(n).call(this,t,r,null,o),t}},779:function(t,e,n){"use strict";function r(t){return"string"==typeof t}function o(t){return"number"==typeof t}function i(t){return"function"==typeof t}function u(t){return null!=t}function a(t){return"object"===Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}n.d(e,{Et:function(){return o},Kg:function(){return r},Qd:function(){return a},Tn:function(){return i},t2:function(){return u}})},822:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(735));function i(t,e){return function(){var n=this.traits(),r=this.properties?this.properties():{};return o.default(n,"address."+t)||o.default(n,t)||(e?o.default(n,"address."+e):null)||(e?o.default(n,e):null)||o.default(r,"address."+t)||o.default(r,t)||(e?o.default(r,"address."+e):null)||(e?o.default(r,e):null)}}e.default=function(t){t.zip=i("postalCode","zip"),t.country=i("country"),t.street=i("street"),t.state=i("state"),t.city=i("city"),t.region=i("region")}},827:function(t,e){"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.clone=void 0,e.clone=function t(e){if("object"!==n(e))return e;if("[object Object]"===Object.prototype.toString.call(e)){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=t(e[o]));return r}return Array.isArray(e)?e.map(t):e}},834:function(t,e,n){"use strict";n.d(e,{d:function(){return s},j:function(){return c}});var r=n(659),o=n(435),i=n(608),u=function(){function t(){this._logs=[]}return t.prototype.log=function(t,e,n){var r=new Date;this._logs.push({level:t,message:e,time:r,extras:n})},Object.defineProperty(t.prototype,"logs",{get:function(){return this._logs},enumerable:!1,configurable:!0}),t.prototype.flush=function(){if(this.logs.length>1){var t=this._logs.reduce(function(t,e){var n,r,o,u=(0,i.Cl)((0,i.Cl)({},e),{json:JSON.stringify(e.extras,null," "),extras:e.extras});delete u.time;var a=null!==(o=null===(r=e.time)||void 0===r?void 0:r.toISOString())&&void 0!==o?o:"";return t[a]&&(a="".concat(a,"-").concat(Math.random())),(0,i.Cl)((0,i.Cl)({},t),((n={})[a]=u,n))},{});console.table?console.table(t):console.log(t)}else this.logs.forEach(function(t){var e=t.level,n=t.message,r=t.extras;"info"===e||"debug"===e?console.log(n,null!=r?r:""):console[e](n,null!=r?r:"")});this._logs=[]},t}(),a=n(0),s=function(t){var e,n,r;this.retry=null===(e=t.retry)||void 0===e||e,this.type=null!==(n=t.type)&&void 0!==n?n:"plugin Error",this.reason=null!==(r=t.reason)&&void 0!==r?r:""},c=function(){function t(t,e,n,o){void 0===e&&(e=(0,r.v4)()),void 0===n&&(n=new a.r),void 0===o&&(o=new u),this.attempts=0,this.event=t,this._id=e,this.logger=o,this.stats=n}return t.system=function(){},t.prototype.isSame=function(t){return t.id===this.id},t.prototype.cancel=function(t){if(t)throw t;throw new s({reason:"Context Cancel"})},t.prototype.log=function(t,e,n){this.logger.log(t,e,n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),t.prototype.updateEvent=function(t,e){var n;if("integrations"===t.split(".")[0]){var r=t.split(".")[1];if(!1===(null===(n=this.event.integrations)||void 0===n?void 0:n[r]))return this.event}return(0,o.J)(this.event,t,e),this.event},t.prototype.failedDelivery=function(){return this._failedDelivery},t.prototype.setFailedDelivery=function(t){this._failedDelivery=t},t.prototype.logs=function(){return this.logger.logs},t.prototype.flush=function(){this.logger.flush(),this.stats.flush()},t.prototype.toJSON=function(){return{id:this._id,event:this.event,logs:this.logger.logs,metrics:this.stats.metrics}},t}()},896:function(t){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},955:function(t,e){"use strict";var n=/\d{10}/;e.is=function(t){return n.test(t)},e.parse=function(t){var e=1e3*parseInt(t,10);return new Date(e)}}},r={};function o(t){var e=r[t];if(void 0!==e)return e.exports;var i=r[t]={exports:{}};return n[t].call(i.exports,i,i.exports,o),i.exports}o.m=n,o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,{a:e}),e},o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.f={},o.e=function(t){return Promise.all(Object.keys(o.f).reduce(function(e,n){return o.f[n](t,e),e},[]))},o.u=function(t){return{248:"auto-track",538:"queryString",751:"middleware"}[t]+"."+{248:"d47dd4242030859040a4",538:"696c75a7dfa140b81497",751:"d8fb6c705fb712e3fb0b"}[t]+".js"},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t={},e="@segment/analytics-signals:",o.l=function(n,r,i,u){if(t[n])t[n].push(r);else{var a,s;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var f=c[l];if(f.getAttribute("src")==n||f.getAttribute("data-webpack")==e+i){a=f;break}}a||(s=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",e+i),a.src=n),t[n]=[r];var p=function(e,r){a.onerror=a.onload=null,clearTimeout(d);var o=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach(function(t){return t(r)}),e)return e(r)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),s&&document.head.appendChild(a)}},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t;o.g.importScripts&&(t=o.g.location+"");var e=o.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=n[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t}(),function(){var t={748:0};o.f.j=function(e,n){var r=o.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(function(n,o){r=t[e]=[n,o]});n.push(r[2]=i);var u=o.p+o.u(e),a=new Error;o.l(u,function(n){if(o.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),u=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+i+": "+u+")",a.name="ChunkLoadError",a.type=i,a.request=u,r[1](a)}},"chunk-"+e,e)}};var e=function(e,n){var r,i,u=n[0],a=n[1],s=n[2],c=0;if(u.some(function(e){return 0!==t[e]})){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(s)s(o)}for(e&&e(n);c<u.length;c++)i=u[c],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0},n=self.webpackChunk_segment_analytics_signals=self.webpackChunk_segment_analytics_signals||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var i={};!function(){"use strict";o.r(i),o.d(i,{Signals:function(){return Sa},SignalsPlugin:function(){return Aa}});var t=function(){var t=new URLSearchParams(window.location.search),e=t.get("segment_signals_debug")||t.get("seg_signals_debug");if("true"===e||"false"===e)return"true"===e};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,a(r.key),r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t,e,n){return(e=a(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,n||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}var s=r(function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,"storage",void 0),u(this,"setItem",function(t,e){try{var r=JSON.stringify(e);n.storage.setItem(t,r)}catch(n){console.warn("Storage set error",{key:t,value:e},n)}}),u(this,"getItem",function(t){try{var e=n.storage.getItem(t);if(null===e)return;return JSON.parse(e)}catch(e){console.warn("Storage retrieval error",{key:t},e)}}),this.storage=e});function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y(r.key),r)}}function d(t,e,n){return(e=y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var h=function(){return e=function e(){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"logLevelKey","segment_signals_log_level"),d(this,"storage",new s(window.sessionStorage)),d(this,"enableLogging",function(t){n.storage.setItem(n.logLevelKey,t)}),d(this,"disableLogging",function(){n.storage.setItem(n.logLevelKey,"off")}),d(this,"log",function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=console).log.apply(e,["[signals:".concat(t,"]")].concat(r))}),d(this,"info",function(){if("info"===n.logLevel||"debug"===n.logLevel){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.log.apply(n,["info"].concat(e))}}),d(this,"debug",function(){if("debug"===n.logLevel){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.log.apply(n,["debug"].concat(e))}}),d(this,"logSignal",function(t){n.info.apply(n,["New signal:",t.type,t.data].concat(l("interaction"===t.type&&"change"in t.data?["change:",JSON.stringify(t.data.change,null,2)]:[])))});var r=function(){var t=new URLSearchParams(window.location.search),e=t.get("segment_signals_log_level")||t.get("seg_signals_log_level");if("info"===e||"debug"===e||"off"===e)return e;"string"==typeof e&&console.error('Invalid signals_log_level: "'.concat(e,'". Valid options are: info, debug, off'))}();void 0!==r?"off"===r?this.disableLogging():this.enableLogging(r):!0===t()&&this.enableLogging("info")},(n=[{key:"logLevel",get:function(){var t;return null!==(t=this.storage.getItem(this.logLevelKey))&&void 0!==t?t:"off"}}])&&p(e.prototype,n),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}(),v=new h;function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach(function(e){w(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function w(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=b(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==b(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var S=function(t,e){return{index:void 0,timestamp:(new Date).toISOString(),anonymousId:"",type:t,context:{library:{name:"@segment/analytics-next",version:"0.0.0"},signalsRuntime:""},data:g(g({},e),{},{page:{path:location.pathname,referrer:document.referrer,title:document.title,search:location.search,url:location.href,hostname:location.hostname,hash:location.hash}})}},O=function(t){return S("interaction",t)},j=function(t){return S("navigation",t)},P=function(t){return g({},S("network",g(g({},t),{},{url:(e=t.url,e.startsWith("http")?e:e.startsWith("/")?window.location.origin+e:e.includes(".")?"".concat(location.protocol,"//").concat(e):window.location.origin+"/"+e)})));var e};function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function x(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return _(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(_(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,_(f,"constructor",c),_(c,"constructor",s),s.displayName="GeneratorFunction",_(c,o,"GeneratorFunction"),_(f),_(f,o,"Generator"),_(f,r,function(){return this}),_(f,"toString",function(){return"[object Generator]"}),(x=function(){return{w:i,m:p}})()}function _(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}_=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){_(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},_(t,e,n,r)}function I(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,C(r.key),r)}}function T(t,e,n){return(e=C(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C(t){var e=function(t,e){if("object"!=k(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==k(e)?e:e+""}var A=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),T(this,"instance",void 0),T(this,"edgeFnSettings",void 0),this.instance=e,this.edgeFnSettings=this.parseEdgeFnSettings(e.settings.cdnSettings)},e=[{key:"parseEdgeFnSettings",value:function(t){var e=t.edgeFunction;if(e&&"downloadURL"in e)return e}},{key:"createSegmentInstrumentationEventGenerator",value:function(){var t,e,n=this,r=!1,o={id:"segment-event-generator",register:(t=x().m(function t(e){return x().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,n.instance.addSourceMiddleware(function(t){var n,o=t.payload,i=t.next;if(!r){var u,a=o.obj;return"Signal"===(null===(n=a.context.__eventOrigin)||void 0===n?void 0:n.type)||e.emit(S("instrumentation",{rawEvent:u=a,type:u.type})),i(o)}});case 1:return t.a(2,function(){r=!0})}},t)}),e=function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){I(i,r,o,u,a,"next",t)}function a(t){I(i,r,o,u,a,"throw",t)}u(void 0)})},function(t){return e.apply(this,arguments)})};return o}}],e&&E(t.prototype,e),n&&E(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach(function(e){G(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function G(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=L(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==L(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return H(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(H(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,H(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,H(f,"constructor",c),H(c,"constructor",s),s.displayName="GeneratorFunction",H(c,o,"GeneratorFunction"),H(f),H(f,o,"Generator"),H(f,r,function(){return this}),H(f,"toString",function(){return"[object Generator]"}),(D=function(){return{w:i,m:p}})()}function H(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}H=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){H(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},H(t,e,n,r)}function N(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function R(t){return new K(t,0)}function B(t){var e,n;function r(e,n){try{var i=t[e](n),u=i.value,a=u instanceof K;Promise.resolve(a?u.v:u).then(function(n){if(a){var s="return"===e?"return":"next";if(!u.k||n.done)return r(s,n);n=t[s](n).value}o(i.done?"return":"normal",n)},function(t){r("throw",t)})}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?r(e.key,e.arg):n=null}this._invoke=function(t,o){return new Promise(function(i,u){var a={key:t,arg:o,resolve:i,reject:u,next:null};n?n=n.next=a:(e=n=a,r(t,o))})},"function"!=typeof t.return&&(this.return=void 0)}function K(t,e){this.v=t,this.k=e}B.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},B.prototype.next=function(t){return this._invoke("next",t)},B.prototype.throw=function(t){return this._invoke("throw",t)},B.prototype.return=function(t){return this._invoke("return",t)};var Z,Y,X=function(t,e){return e.some(function(e){return t instanceof e})};var z=new WeakMap,q=new WeakMap,W=new WeakMap;var V={get:function(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return z.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $(t[e])},set:function(t,e,n){return t[e]=n,!0},has:function(t,e){return t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t}};function J(t){V=t(V)}function U(t){return(Y||(Y=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(tt(this),n),$(this.request)}:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return $(t.apply(tt(this),n))}}function Q(t){return"function"==typeof t?U(t):(t instanceof IDBTransaction&&function(t){if(!z.has(t)){var e=new Promise(function(e,n){var r=function(){t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=function(){e(),r()},i=function(){n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)});z.set(t,e)}}(t),X(t,Z||(Z=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,V):t)}function $(t){if(t instanceof IDBRequest)return e=t,n=new Promise(function(t,n){var r=function(){e.removeEventListener("success",o),e.removeEventListener("error",i)},o=function(){t($(e.result)),r()},i=function(){n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",i)}),W.set(n,e),n;var e,n;if(q.has(t))return q.get(t);var r=Q(t);return r!==t&&(q.set(t,r),W.set(r,t)),r}var tt=function(t){return W.get(t)};function et(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,o=n.upgrade,i=n.blocking,u=n.terminated,a=indexedDB.open(t,e),s=$(a);return o&&a.addEventListener("upgradeneeded",function(t){o($(a.result),t.oldVersion,t.newVersion,$(a.transaction),t)}),r&&a.addEventListener("blocked",function(t){return r(t.oldVersion,t.newVersion,t)}),s.then(function(t){u&&t.addEventListener("close",function(){return u()}),i&&t.addEventListener("versionchange",function(t){return i(t.oldVersion,t.newVersion,t)})}).catch(function(){}),s}var nt=["get","getKey","getAll","getAllKeys","count"],rt=["put","add","delete","clear"],ot=new Map;function it(t,e){if(t instanceof IDBDatabase&&!(e in t)&&"string"==typeof e){if(ot.get(e))return ot.get(e);var n=e.replace(/FromIndex$/,""),r=e!==n,o=rt.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(o||nt.includes(n))){var i=function(){var t,e=(t=D().m(function t(e){var i,u,a,s,c,l,f=arguments;return D().w(function(t){for(;;)switch(t.n){case 0:for(u=this.transaction(e,o?"readwrite":"readonly"),a=u.store,s=f.length,c=new Array(s>1?s-1:0),l=1;l<s;l++)c[l-1]=f[l];return r&&(a=a.index(c.shift())),t.n=1,Promise.all([(i=a)[n].apply(i,c),o&&u.done]);case 1:return t.a(2,t.v[0])}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){N(i,r,o,u,a,"next",t)}function a(t){N(i,r,o,u,a,"throw",t)}u(void 0)})});return function(t){return e.apply(this,arguments)}}();return ot.set(e,i),i}}}J(function(t){return M(M({},t),{},{get:function(e,n,r){return it(e,n)||t.get(e,n,r)},has:function(e,n){return!!it(e,n)||t.has(e,n)}})});var ut=["continue","continuePrimaryKey","advance"],at={},st=new WeakMap,ct=new WeakMap,lt={get:function(t,e){if(!ut.includes(e))return t[e];var n=at[e];return n||(n=at[e]=function(){var t;st.set(this,(t=ct.get(this))[e].apply(t,arguments))}),n}};function ft(){return pt.apply(this,arguments)}function pt(){var t;return t=D().m(function t(){var e,n,r,o=arguments;return D().w(function(t){for(;;)switch(t.n){case 0:if((e=this)instanceof IDBCursor){t.n=2;break}return t.n=1,R((n=e).openCursor.apply(n,o));case 1:e=t.v;case 2:if(e){t.n=3;break}return t.a(2);case 3:r=new Proxy(e,lt),ct.set(r,e),W.set(r,tt(e));case 4:if(!e){t.n=7;break}return t.n=5,r;case 5:return t.n=6,R(st.get(r)||e.continue());case 6:e=t.v,st.delete(r),t.n=4;break;case 7:return t.a(2)}},t,this)}),pt=function(){return new B(t.apply(this,arguments))},pt.apply(this,arguments)}function dt(t,e){return e===Symbol.asyncIterator&&X(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===e&&X(t,[IDBIndex,IDBObjectStore])}function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function ht(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return vt(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(vt(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,vt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,vt(f,"constructor",c),vt(c,"constructor",s),s.displayName="GeneratorFunction",vt(c,o,"GeneratorFunction"),vt(f),vt(f,o,"Generator"),vt(f,r,function(){return this}),vt(f,"toString",function(){return"[object Generator]"}),(ht=function(){return{w:i,m:p}})()}function vt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}vt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){vt(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},vt(t,e,n,r)}function bt(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function mt(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){bt(i,r,o,u,a,"next",t)}function a(t){bt(i,r,o,u,a,"throw",t)}u(void 0)})}}function gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jt(r.key),r)}}function St(t,e,n){return e&&wt(t.prototype,e),n&&wt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ot(t,e,n){return(e=jt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jt(t){var e=function(t,e){if("object"!=yt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yt(e)?e:e+""}J(function(t){return M(M({},t),{},{get:function(e,n,r){return dt(e,n)?ft:t.get(e,n,r)},has:function(e,n){return dt(e,n)||t.has(e,n)}})});var Pt=function(){function t(e){var n;gt(this,t),Ot(this,"db",void 0),Ot(this,"maxBufferSize",void 0),Ot(this,"sessionKeyStorage",new s(window.sessionStorage)),this.maxBufferSize=null!==(n=e.maxBufferSize)&&void 0!==n?n:100,this.db=this.initSignalDB()}return St(t,[{key:"getStore",value:(a=mt(ht().m(function e(n,r){var o,i;return ht().w(function(e){for(;;)switch(e.n){case 0:if(null==r){e.n=1;break}i=r,e.n=3;break;case 1:return e.n=2,this.db;case 2:i=e.v;case 3:return o=i.transaction(t.STORE_NAME,n).objectStore(t.STORE_NAME),e.a(2,o)}},e,this)})),function(t,e){return a.apply(this,arguments)})},{key:"initSignalDB",value:(u=mt(ht().m(function e(){var n,r;return ht().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,et(t.DB_NAME,1,{upgrade:function(e){e.createObjectStore(t.STORE_NAME,{autoIncrement:!0})}});case 1:return n=e.v,v.debug("Signals Buffer (indexDB) initialized"),e.n=2,this.getStore("readwrite",n);case 2:return r=e.v,e.n=3,this.clearStoreIfNeeded(r);case 3:return e.n=4,this.countAndDeleteOldestIfNeeded(r,!0);case 4:return e.n=5,r.transaction.done;case 5:return e.a(2,n)}},e,this)})),function(){return u.apply(this,arguments)})},{key:"clearStoreIfNeeded",value:(i=mt(ht().m(function t(e){var n;return ht().w(function(t){for(;;)switch(t.n){case 0:if(n="segment_signals_db_session_key",sessionStorage.getItem(n)){t.n=2;break}return this.sessionKeyStorage.setItem(n,!0),t.n=1,e.clear();case 1:v.debug("New Session, so signals buffer cleared");case 2:return t.a(2)}},t,this)})),function(t){return i.apply(this,arguments)})},{key:"add",value:(o=mt(ht().m(function t(e){var n;return ht().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.getStore("readwrite");case 1:return n=t.v,t.n=2,n.add(e);case 2:return t.n=3,this.countAndDeleteOldestIfNeeded(n);case 3:return t.a(2,n.transaction.done)}},t,this)})),function(t){return o.apply(this,arguments)})},{key:"countAndDeleteOldestIfNeeded",value:(r=mt(ht().m(function t(e){var n,r,o,i=arguments;return ht().w(function(t){for(;;)switch(t.n){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],t.n=1,e.count();case 1:if(!((r=t.v)>this.maxBufferSize)){t.n=9;break}return t.n=2,e.openCursor();case 2:if(!(o=t.v)){t.n=9;break}if(!n){t.n=7;break}case 3:if(!(r>this.maxBufferSize)){t.n=6;break}return t.n=4,o.delete();case 4:return t.n=5,o.continue();case 5:r--,t.n=3;break;case 6:v.debug("Signals Buffer: Purged signals to max buffer size of ".concat(this.maxBufferSize)),t.n=9;break;case 7:return t.n=8,o.delete();case 8:r--;case 9:return t.a(2)}},t,this)})),function(t){return r.apply(this,arguments)})},{key:"getAll",value:(n=mt(ht().m(function t(){var e,n;return ht().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.getStore("readonly");case 1:return e=t.v,t.n=2,e.getAll();case 2:return n=t.v,t.n=3,e.transaction.done;case 3:return t.a(2,n.reverse())}},t,this)})),function(){return n.apply(this,arguments)})},{key:"clear",value:(e=mt(ht().m(function t(){var e;return ht().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.getStore("readwrite");case 1:return e=t.v,t.n=2,e.clear();case 2:return t.n=3,e.transaction.done;case 3:return t.a(2)}},t,this)})),function(){return e.apply(this,arguments)})}],[{key:"deleteDatabase",value:function(){return indexedDB.deleteDatabase(t.DB_NAME)}}]);var e,n,r,o,i,u,a}();Ot(Pt,"DB_NAME","Segment Signals Buffer"),Ot(Pt,"STORE_NAME","signals");var kt=function(){return St(function t(e){var n;gt(this,t),Ot(this,"storageKey","segment_signals_buffer"),Ot(this,"maxBufferSize",void 0),this.maxBufferSize=null!==(n=e.maxBufferSize)&&void 0!==n?n:100},[{key:"add",value:function(t){var e=this.getAll();e.unshift(t),e.length>this.maxBufferSize&&e.splice(-1),sessionStorage.setItem(this.storageKey,JSON.stringify(e))}},{key:"clear",value:function(){sessionStorage.removeItem(this.storageKey)}},{key:"getAll",value:function(){var t=sessionStorage.getItem(this.storageKey);return t?JSON.parse(t):[]}}])}(),xt=function(){return St(function t(e){gt(this,t),Ot(this,"store",void 0),this.store=e},[{key:"add",value:(n=mt(ht().m(function t(e){var n;return ht().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.store.add(e);case 1:return t.a(2,t.v);case 2:return t.p=2,n=t.v,console.error(n),t.a(2,void 0)}},t,this,[[0,2]])})),function(t){return n.apply(this,arguments)})},{key:"getAll",value:(e=mt(ht().m(function t(){var e;return ht().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.store.getAll();case 1:return t.a(2,t.v);case 2:return t.p=2,e=t.v,console.error(e),t.a(2,[])}},t,this,[[0,2]])})),function(){return e.apply(this,arguments)})},{key:"clear",value:(t=mt(ht().m(function t(){var e;return ht().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.store.clear();case 1:return t.a(2,t.v);case 2:return t.p=2,e=t.v,console.error(e),t.a(2,void 0)}},t,this,[[0,2]])})),function(){return t.apply(this,arguments)})}]);var t,e,n}();function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function It(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?It(Object(n),!0).forEach(function(e){Rt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Tt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Mt(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(a)throw i}}}}function Ct(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return At(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(At(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,At(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,At(f,"constructor",c),At(c,"constructor",s),s.displayName="GeneratorFunction",At(c,o,"GeneratorFunction"),At(f),At(f,o,"Generator"),At(f,r,function(){return this}),At(f,"toString",function(){return"[object Generator]"}),(Ct=function(){return{w:i,m:p}})()}function At(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}At=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){At(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},At(t,e,n,r)}function Lt(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function Ft(t){return function(t){if(Array.isArray(t))return Gt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Mt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mt(t,e){if(t){if("string"==typeof t)return Gt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(t,e):void 0}}function Gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Bt(r.key),r)}}function Nt(t,e,n){return e&&Ht(t.prototype,e),n&&Ht(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rt(t,e,n){return(e=Bt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bt(t){var e=function(t,e){if("object"!=_t(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=_t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_t(e)?e:e+""}var Kt=function(){return Nt(function t(e){Dt(this,t),Rt(this,"subscriber",void 0),Rt(this,"loadedPromise",void 0),this.subscriber=e},[{key:"load",value:function(t){"function"!=typeof this.subscriber&&(this.loadedPromise=Promise.resolve(this.subscriber.load(t)))}},{key:"process",value:function(t){var e=this.subscriber;if("function"==typeof e)e(t);else{if(!this.loadedPromise)throw new Error("load() must be called before process()");this.loadedPromise.then(function(){return e.process(t)})}}}])}(),Zt=function(){return Nt(function t(e){Dt(this,t),Rt(this,"subscribers",new Set),Rt(this,"middlewares",new Set),Rt(this,"signalQueue",[]),Rt(this,"startedCtx",void 0),null!=e&&e.middleware&&this.addMiddleware.apply(this,Ft(e.middleware))},[{key:"start",value:(t=Ct().m(function t(e){var n;return Ct().w(function(t){for(;;)switch(t.n){case 0:if(!this.startedCtx){t.n=1;break}return t.a(2,this);case 1:return t.n=2,Promise.all(Ft(this.middlewares).map(function(t){return t.load(e)}));case 2:for(this.subscribers.forEach(function(t){t.load(e)}),this.startedCtx=e;this.signalQueue.length>0;)n=this.signalQueue.shift(),this.processAndEmit(n);return t.a(2,this)}},t,this)}),e=function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){Lt(i,r,o,u,a,"next",t)}function a(t){Lt(i,r,o,u,a,"throw",t)}u(void 0)})},function(t){return e.apply(this,arguments)})},{key:"emit",value:function(t){this.startedCtx?this.processAndEmit(t):this.signalQueue.push(t)}},{key:"addMiddleware",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){t.startedCtx&&e.load(t.startedCtx),t.middlewares.add(e)}),this}},{key:"removeMiddleware",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){return t.middlewares.delete(e)}),this}},{key:"subscribe",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.map(function(t){return new Kt(t)}).forEach(function(e){t.subscribers.has(e)||(t.startedCtx&&e.load(t.startedCtx),t.subscribers.add(e))}),this}},{key:"unsubscribe",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){var n=Ft(t.subscribers).find(function(t){return t.subscriber===e});n&&t.subscribers.delete(n)}),this}},{key:"processAndEmit",value:function(t){var e,n=Tt(this.middlewares);try{for(n.s();!(e=n.n()).done;){if(null===e.value.process(t))return}}catch(t){n.e(t)}finally{n.f()}var r,o=Tt(this.subscribers);try{for(o.s();!(r=o.n()).done;){var i=r.value,u=Et({},t);i.process(u)}}catch(t){o.e(t)}finally{o.f()}}}]);var t,e}();function Yt(t){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yt(t)}function Xt(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Yt(t)+" is not iterable")}function zt(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function qt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return Wt(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Wt(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Wt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Wt(f,"constructor",c),Wt(c,"constructor",s),s.displayName="GeneratorFunction",Wt(c,o,"GeneratorFunction"),Wt(f),Wt(f,o,"Generator"),Wt(f,r,function(){return this}),Wt(f,"toString",function(){return"[object Generator]"}),(qt=function(){return{w:i,m:p}})()}function Wt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Wt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){Wt(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},Wt(t,e,n,r)}function Vt(t){return function(t){if(Array.isArray(t))return Jt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Jt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ut(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function Qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,te(r.key),r)}}function $t(t,e,n){return(e=te(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function te(t){var e=function(t,e){if("object"!=Yt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Yt(e)?e:e+""}var ee=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),$t(this,"analytics",void 0),$t(this,"sandbox",void 0),this.analytics=e,this.sandbox=n},e=[{key:"process",value:(r=qt().m(function t(e,n){var r,o,i,u,a,s,c=this;return qt().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.sandbox.execute(e,n);case 1:r=t.v,t.n=3;break;case 2:return t.p=2,u=t.v,console.error("Error processing signal",{signal:e,signals:n},u),t.a(2);case 3:o=qt().m(function t(){var e;return qt().w(function(t){for(;;)switch(t.n){case 0:r[e=i].forEach(function(t){var n;v.info("New method call:","analytics.".concat(e,"()"),t),(n=c.analytics)[e].apply(n,Vt(t))});case 1:return t.a(2)}},t)}),a=zt(r);case 4:if((s=a()).done){t.n=6;break}return i=s.value,t.d(Xt(o()),5);case 5:t.n=4;break;case 6:return t.a(2)}},t,this,[[0,2]])}),o=function(){var t=this,e=arguments;return new Promise(function(n,o){var i=r.apply(t,e);function u(t){Ut(i,n,o,u,a,"next",t)}function a(t){Ut(i,n,o,u,a,"throw",t)}u(void 0)})},function(t,e){return o.apply(this,arguments)})},{key:"cleanup",value:function(){return this.sandbox.destroy()}}],e&&Qt(t.prototype,e),n&&Qt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function re(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ie(r.key),r)}}function oe(t,e,n){return e&&re(t.prototype,e),n&&re(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ie(t){var e=function(t,e){if("object"!=ne(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ne(e)?e:e+""}var ue=oe(function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.find=function(t,n,r){return e.filter(t,n,r)[0]},this.filter=function(t,n,r){return e.signalBuffer.slice(e.signalBuffer.indexOf(t)+1).filter(function(t){return t.type===n}).filter(function(t){return r?r(t):function(){return!0}})},this.signalBuffer=n,this._maxBufferSize=1e3});function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ce(r.key),r)}}function ce(t){var e=function(t,e){if("object"!=ae(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ae(e)?e:e+""}function le(t,e,n){return e=pe(e),function(t,e){if(e&&("object"==ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fe()?Reflect.construct(e,n||[],pe(t).constructor):e.apply(t,n))}function fe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(fe=function(){return!!t})()}function pe(t){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pe(t)}function de(t,e){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},de(t,e)}var ye=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),le(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&de(t,e)}(e,t),n=e,r&&se(n.prototype,r),o&&se(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o}(ue),he=function(){return'\n"use strict";(()=>{function o(e){"@babel/helpers - typeof";return o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function d(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){var t=O(e,"string");return o(t)=="symbol"?t:t+""}function O(e,t){if(o(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(o(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b=d(function e(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];S(this,e),p(this,"find",function(n,c,u){return t.filter(n,c,u)[0]}),p(this,"filter",function(n,c,u){var _=function(h){return h.type===c};return t.signalBuffer.slice(t.signalBuffer.indexOf(n)+1).filter(_).filter(function(a){return u?u(a):function(){return!0}})}),this.signalBuffer=r,this._maxBufferSize=1e3});function i(e){"@babel/helpers - typeof";return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(e)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w(n.key),n)}}function P(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e){var t=j(e,"string");return i(t)=="symbol"?t:t+""}function j(e,t){if(i(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t,r){return t=f(t),T(e,v()?Reflect.construct(t,r||[],f(e).constructor):t.apply(e,r))}function T(e,t){if(t&&(i(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}function E(e){if(e===void 0)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return e}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!e})()}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(e)}function B(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},l(e,t)}var g=function(e){function t(){return R(this,t),C(this,t,arguments)}return B(t,e),P(t)}(b);Object.assign(globalThis,{signals:new g});})();\n'};function ve(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],s=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return be(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function me(t,e){var n=function(t){return Array.prototype.slice.call(window.document.querySelectorAll("script")).find(function(e){return e.src===t})}(t);if(void 0!==n){var r=null==n?void 0:n.getAttribute("status");if("loaded"===r)return Promise.resolve(n);if("loading"===r)return new Promise(function(t,e){n.addEventListener("load",function(){return t(n)}),n.addEventListener("error",function(t){return e(t)})})}return new Promise(function(n,r){var o=window.document.createElement("script");o.type="text/javascript",o.src=t,o.async=!0,o.setAttribute("status","loading");for(var i=0,u=Object.entries(null!=e?e:{});i<u.length;i++){var a=ve(u[i],2),s=a[0],c=a[1];o.setAttribute(s,c)}o.onload=function(){o.onerror=o.onload=null,o.setAttribute("status","loaded"),n(o)},o.onerror=function(){o.onerror=o.onload=null,o.setAttribute("status","error"),r(new Error("Failed to load ".concat(t)))};var l,f=window.document.querySelector("script");f?null===(l=f.parentElement)||void 0===l||l.insertBefore(o,f):window.document.head.appendChild(o)})}var ge=atob("PHNjcmlwdD4KICBmdW5jdGlvbiB3b3JrZXJTY3JpcHQoKSB7CiAgICAidXNlIHN0cmljdCI7KCgpPT57ZnVuY3Rpb24gYihlLHIsdCl7cmV0dXJuIHAoSlNPTi5wYXJzZShlKSxyLHQpfXZhciBTPSgpPT4oZ2xvYmFsVGhpcy53b3JrZXJib3hJbmNyZW1lbnRvcj0oZ2xvYmFsVGhpcy53b3JrZXJib3hJbmNyZW1lbnRvcnx8MCkrMSxnbG9iYWxUaGlzLndvcmtlcmJveEluY3JlbWVudG9yKyJfIitBcnJheSgyMCkuZmlsbCgiIUAjJCVeJiooKV8rLT0wMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiIpLm1hcChlPT5lW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSplLmxlbmd0aCldKS5qb2luKCIiKSk7ZnVuY3Rpb24geCgpe2xldCBlPXt9O3JldHVybntzdG9yZTplLGFkZDpuPT57bGV0IG89UygpO3JldHVybiBlW29dPW4sb30sZ2V0Om49PmVbbl19fWZ1bmN0aW9uIG0oZSxyLHQpe2lmKHR5cGVvZiBlPT0iZnVuY3Rpb24iKXJldHVyblsiY2FsbGJhY2siLHIoZSldO2lmKGUgaW5zdGFuY2VvZiBBcnJheSlyZXR1cm5bImFycmF5IixlLm1hcChuPT5tKG4scix0KSldO2lmKHR5cGVvZiBlPT0ib2JqZWN0IiYmZSE9PW51bGwpe2xldCBuPXt9O2ZvcihsZXQgbyBpbiBlKW5bb109bShlW29dLHIsdCk7cmV0dXJuWyJvYmplY3QiLG5dfWVsc2UgcmV0dXJuWyJsaXRlcmFsIixlXX1mdW5jdGlvbiBhKGUscix0KXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkobShlLHIsdCkpfWZ1bmN0aW9uIHAoZSxyLHQpe2lmKGVbMF09PT0iY2FsbGJhY2siKXJldHVybiguLi5uKT0+dChlWzFdLGEobixyLHQpKTtpZihlWzBdPT09ImFycmF5IilyZXR1cm4gZVsxXS5tYXAobj0+cChuLHIsdCkpO2lmKGVbMF09PT0ib2JqZWN0Iil7bGV0IG49e307Zm9yKGxldCBvIGluIGVbMV0pbltvXT1wKGVbMV1bb10scix0KTtyZXR1cm4gbn1lbHNle2lmKGVbMF09PT0ibGl0ZXJhbCIpcmV0dXJuIGVbMV07dGhyb3cgRXJyb3IoYFVuZXhwZWN0ZWQgYXJnIHR5cGU6ICR7ZVswXX1gKX19ZnVuY3Rpb24gayhlLHIsdCl7cmV0dXJuIHAoSlNPTi5wYXJzZShlKSxyLHQpfWFzeW5jIGZ1bmN0aW9uIEUoZSxyKXtyZXR1cm4gYXdhaXQgRnVuY3Rpb24uYXBwbHkobnVsbCxbLi4uT2JqZWN0LmtleXMoZSksYHJldHVybiAoYXN5bmMgZnVuY3Rpb24gc2FuZGJveCAoKSB7JHtyfSB9KSgpYF0pLmFwcGx5KG51bGwsWy4uLk9iamVjdC52YWx1ZXMoZSldKX12YXIgdz0oZSxyKT0+e2lmKCFlLnN0YWNrKXJldHVybiBlLm1lc3NhZ2U7bGV0IHQ9ZS5zdGFjay5zcGxpdChgCmApLG49cz0+dHlwZW9mIHM9PSJzdHJpbmciP3BhcnNlSW50KHMsMTApOnM7cmV0dXJuW3RbMF0sLi4udC5maWx0ZXIocz0+cy5pbmNsdWRlcygiKGV2YWwgYXQgc2NvcGVkRXZhbCIpKS5tYXAocz0+e2xldCBkPXMuc3BsaXQoIihldmFsIGF0IHNjb3BlZEV2YWwgKCIpLFssbF09cy5zcGxpdCgiPGFub255bW91cz4iKSxbLGcsZl09bC5zbGljZSgwLC0xKS5zcGxpdCgiOiIpO3JldHVybmAke2RbMF19KDxzYW5kYm94Pjoke24oZyktM306JHtmfSlgfSldLnNsaWNlKDAscikuam9pbihgCmApfTtzZWxmLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLGU9PntsZXQgcj1lLnBvcnRzWzBdLHQ9eCgpLG49KG8scyk9Pm5ldyBQcm9taXNlKGQ9PntyLnBvc3RNZXNzYWdlKFsiY2FsbGJhY2siLHtpZDpvLGFyZ3M6cyxyZXNvbHZlOnQuYWRkKGQpfV0pfSk7ci5vbm1lc3NhZ2U9YXN5bmMgbz0+e2xldFtzLGRdPW8uZGF0YSx7aWQ6bCxlcnJvcklkOmcsY29kZTpmLHNjb3BlOmgsYXJnczp2LHJlc29sdmU6TSxyZWplY3Q6Rn09ZDtpZihzPT09ImV4ZWN1dGUiKXtsZXQgeT1iKGgsdC5hZGQsbik7dHJ5e2xldCBpPWF3YWl0IEUoeSxmKTtyLnBvc3RNZXNzYWdlKFsicmV0dXJuIix7aWQ6bCxhcmdzOmEoW2ldLHQuYWRkLG4pfV0pfWNhdGNoKGkpe2xldCBjPWk7dHJ5e2xldCB1PXcoYywtMSk7ci5wb3N0TWVzc2FnZShbImVycm9yIix7aWQ6ZyxhcmdzOmEoW3V8fGMubWVzc2FnZV0sdC5hZGQsbil9XSl9Y2F0Y2h7ci5wb3N0TWVzc2FnZShbImVycm9yIix7aWQ6ZyxhcmdzOmEoW2MubWVzc2FnZV0sdC5hZGQsbil9XSl9fX1pZihzPT09ImNhbGxiYWNrIil7bGV0IHk9ayh2LHQuYWRkLG4pLGk9dC5nZXQobCk7aWYoIWkpcmV0dXJuO3RyeXtsZXQgYz1hd2FpdCBpKC4uLnkpO3IucG9zdE1lc3NhZ2UoWyJyZXR1cm4iLHtpZDpNLGFyZ3M6YShbY10sdC5hZGQsbil9XSl9Y2F0Y2goYyl7bGV0IHU9YyxBPXcodSk7ci5wb3N0TWVzc2FnZShbImVycm9yIix7aWQ6RixhcmdzOmEoW0F8fHUubWVzc2FnZV0sdC5hZGQsbil9XSl9fX19KTt9KSgpOwoKICB9CgogIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGFzeW5jIChldmVudCkgPT4gewogICAgY29uc3QgY29kZSA9IHdvcmtlclNjcmlwdC50b1N0cmluZygpLnNwbGl0KCdcbicpLnNsaWNlKDEsIC0xKS5qb2luKCdcbicpOwogICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb2RlXSwgeyB0eXBlOiAnYXBwbGljYXRpb24vamF2YXNjcmlwdCcgfSkKICAgIGNvbnN0IHdvcmtlciA9IG5ldyBXb3JrZXIoVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKSkKCiAgICB3b3JrZXIucG9zdE1lc3NhZ2UoJ09LJywgZXZlbnQucG9ydHMpOwogIH0pOwo8L3NjcmlwdD4=");function we(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return Se(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Se(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Se(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Se(f,"constructor",c),Se(c,"constructor",s),s.displayName="GeneratorFunction",Se(c,o,"GeneratorFunction"),Se(f),Se(f,o,"Generator"),Se(f,r,function(){return this}),Se(f,"toString",function(){return"[object Generator]"}),(we=function(){return{w:i,m:p}})()}function Se(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Se=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){Se(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},Se(t,e,n,r)}function Oe(t){return function(t){if(Array.isArray(t))return ke(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Pe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],s=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(t,e)||Pe(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(t,e){if(t){if("string"==typeof t)return ke(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ke(t,e):void 0}}function ke(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xe(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function _e(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){xe(i,r,o,u,a,"next",t)}function a(t){xe(i,r,o,u,a,"throw",t)}u(void 0)})}}function Ie(t){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ie(t)}function Ee(){var t={};return{store:t,add:function(e){var n=(globalThis.workerboxIncrementor=(globalThis.workerboxIncrementor||0)+1,globalThis.workerboxIncrementor+"_"+Array(20).fill("!@#$%^&*()_+-=0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz").map(function(t){return t[Math.floor(Math.random()*t.length)]}).join(""));return t[n]=e,n},get:function(e){return t[e]}}}function Te(t,e,n){if("function"==typeof t)return["callback",e(t)];if(t instanceof Array)return["array",t.map(function(t){return Te(t,e,n)})];if("object"===Ie(t)&&null!==t){var r={};for(var o in t)r[o]=Te(t[o],e,n);return["object",r]}return["literal",t]}function Ce(t,e,n){return JSON.stringify(Te(t||{},e,n))}function Ae(t,e,n){return JSON.stringify(Te(t,e,n))}function Le(t,e,n){if("callback"===t[0])return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n(t[1],Ae(o,e,n))};if("array"===t[0])return t[1].map(function(t){return Le(t,e,n)});if("object"===t[0]){var r={};for(var o in t[1])r[o]=Le(t[1][o],e,n);return r}if("literal"===t[0])return t[1];throw Error("Unexpected arg type: ".concat(t[0]))}function Fe(t,e,n){return Le(JSON.parse(t),e,n)}var Me={count:0};function Ge(t,e){Me.count=Me.count+1;var n=new MessageChannel,r=document.createElement("iframe");return r.setAttribute("sandbox","allow-scripts"),r.id="seg-workerbox-".concat(Me.count),r.setAttribute("style","position: fixed; height: 0; width: 0; opacity: 0; top: -100px;"),t?r.src=t:r.srcdoc=ge.toString(),document.body.appendChild(r),n.port1.onmessage=e,new Promise(function(t){r.addEventListener("load",function(){if(!r.contentWindow)throw new Error("iframe.contentWindow is null");r.contentWindow.postMessage("OK","*",[n.port2]),t({postMessage:function(t){return n.port1.postMessage(t)},destroy:function(){return r.remove()}})})})}function De(){return De=_e(we().m(function t(){var e,n,r,o,i=arguments;return we().w(function(t){for(;;)switch(t.n){case 0:return(e=i.length>0&&void 0!==i[0]?i[0]:{}).url&&"/"===e.url.slice(-1)&&(e.url=e.url.slice(0,-1)),e.url=e.url&&new URL(e.url).href,n=Ee(),r=function(t,e){return new Promise(function(r,i){o.postMessage(["callback",{id:t,args:e,resolve:n.add(r),reject:n.add(i)}])})},t.n=1,Ge(e.url,function(){var t=_e(we().m(function t(e){var i,u,a,s,c,l,f,p,d,y,h,v,b,m;return we().w(function(t){for(;;)switch(t.p=t.n){case 0:if(i=je(e.data,2),u=i[0],a=i[1],s=a.id,c=a.args,l=a.resolve,f=a.reject,p=Fe(c,n.add,r),"error"!==u){t.n=1;break}return null===(d=n.get(s))||void 0===d||d(new Error(p[0])),t.a(2);case 1:if("return"!==u){t.n=2;break}return null===(y=n.get(s))||void 0===y||y(p[0]),t.a(2);case 2:if(h=n.get(s)){t.n=3;break}return t.a(2);case 3:return t.p=3,t.n=4,h.apply(void 0,Oe(p));case 4:v=t.v,o.postMessage(["callback",{id:l,args:Ae([v],n.add,r)}]),t.n=6;break;case 5:t.p=5,m=t.v,b=m instanceof Error?m.message:m,o.postMessage(["callback",{id:f,args:Ae([b],n.add,r)}]);case 6:return t.a(2)}},t,null,[[3,5]])}));return function(e){return t.apply(this,arguments)}}());case 1:return o=t.v,t.a(2,{run:function(){var t=_e(we().m(function t(e,i){return we().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t,u){var a=n.add(t),s=n.add(u),c=Ce(i,n.add,r);o.postMessage(["execute",{id:a,errorId:s,code:e,scope:c}])}))},t)}));return function(e,n){return t.apply(this,arguments)}}(),destroy:function(){return o.destroy()},opts:e})}},t)})),De.apply(this,arguments)}var He=["(function () {\n  // polyfill for globalThis\n  if (typeof globalThis === 'undefined') {\n    if (typeof self !== 'undefined') {\n      self.globalThis = self\n    } else if (typeof window !== 'undefined') {\n      window.globalThis = window\n    } else if (typeof global !== 'undefined') {\n      global.globalThis = global\n    } else {\n      throw new Error('Unable to locate global object')\n    }\n  }\n})()"].join("\n");function Ne(t){return Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ne(t)}function Re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Be(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Re(Object(n),!0).forEach(function(e){Ze(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ye(r.key),r)}}function Ze(t,e,n){return(e=Ye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ye(t){var e=function(t,e){if("object"!=Ne(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ne(e)?e:e+""}var Xe=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ze(this,"calls",{page:[],identify:[],track:[],alias:[],screen:[],group:[],reset:[]}),Ze(this,"track",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n[0],i=n[1],u=n[2];try{e.calls.track.push([o,i,e.createOptions(u)])}catch(t){console.error(t)}}),Ze(this,"identify",function(){try{for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n[0],i=n[1],u=n[2];e.calls.identify.push([o,i,e.createOptions(u)])}catch(t){console.error(t)}}),Ze(this,"alias",function(){try{for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n[0],i=n[1],u=n[2];e.calls.alias.push([o,i,e.createOptions(u)])}catch(t){console.error(t)}}),Ze(this,"group",function(){try{for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n[0],i=n[1],u=n[2];e.calls.group.push([o,i,e.createOptions(u)])}catch(t){console.error(t)}}),Ze(this,"page",function(){try{for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n[0],i=n[1],u=n[2],a=n[3],s=!o&&i?"":o;e.calls.page.push([i,s,u,e.createOptions(a)])}catch(t){console.error(t)}}),Ze(this,"screen",function(){try{for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n[0],i=n[1],u=n[2],a=n[3],s=!o&&i?"":o;e.calls.screen.push([i,s,u,e.createOptions(a)])}catch(t){console.error(t)}}),Ze(this,"reset",function(){e.calls.reset.push([])})},e=[{key:"getCalls",value:function(){return this.calls}},{key:"createOptions",value:function(t){return{context:Be(Be({},t),{},{__eventOrigin:{type:"Signal"}})}}}],e&&Ke(t.prototype,e),n&&Ke(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ze(t){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ze(t)}function qe(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return We(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(We(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,We(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,We(f,"constructor",c),We(c,"constructor",s),s.displayName="GeneratorFunction",We(c,o,"GeneratorFunction"),We(f),We(f,o,"Generator"),We(f,r,function(){return this}),We(f,"toString",function(){return"[object Generator]"}),(qe=function(){return{w:i,m:p}})()}function We(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}We=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){We(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},We(t,e,n,r)}function Ve(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function Je(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){Ve(i,r,o,u,a,"next",t)}function a(t){Ve(i,r,o,u,a,"throw",t)}u(void 0)})}}function Ue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,en(r.key),r)}}function $e(t,e,n){return e&&Qe(t.prototype,e),n&&Qe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tn(t,e,n){return(e=en(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function en(t){var e=function(t,e){if("object"!=ze(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ze(e)?e:e+""}var nn=function(){return $e(function t(){Ue(this,t),tn(this,"workerbox",void 0),this.workerbox=function(){return De.apply(this,arguments)}()},[{key:"run",value:(e=Je(qe().m(function t(e,n){var r,o;return qe().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.workerbox;case 1:return r=t.v,t.n=2,r.run(e,n);case 2:t.n=4;break;case 3:t.p=3,o=t.v,console.error("processSignal() error in sandbox",o,{fn:e});case 4:return t.a(2)}},t,this,[[0,3]])})),function(t,n){return e.apply(this,arguments)})},{key:"destroy",value:(t=Je(qe().m(function t(){var e;return qe().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.workerbox;case 1:return e=t.v,t.n=2,e.destroy();case 2:return t.a(2)}},t,this)})),function(){return t.apply(this,arguments)})}]);var t,e}(),rn=function(){return console.warn("processSignal is not defined - have you set up auto-instrumentation on app.segment.com?")},on=$e(function t(e){var n;Ue(this,t),tn(this,"processSignal",void 0);var r=null!==(n=e.edgeFnFetchClient)&&void 0!==n?n:globalThis.fetch,o=Promise.resolve("globalThis.processSignal = function() {}");e.processSignal?o=Promise.resolve(e.processSignal).then(function(t){return"globalThis.processSignal = ".concat(t)}):e.edgeFnDownloadURL?o=r(e.edgeFnDownloadURL).then(function(t){return t.text()}):rn(),this.processSignal=o}),un=function(){return $e(function t(e){Ue(this,t),tn(this,"settings",void 0),tn(this,"jsSandbox",void 0),this.settings=e,this.jsSandbox=new nn},[{key:"execute",value:(t=Je(qe().m(function t(e,n){var r,o,i,u,a,s,c,l,f;return qe().w(function(t){for(;;)switch(t.n){case 0:return r=new Xe,o={analytics:r},v.debug("processing signal",{signal:e,scope:o,signals:n}),a=He,t.n=1,this.settings.processSignal;case 1:return s=t.v,c=he(),l="signals.signalBuffer = ".concat(JSON.stringify(n),";"),f="try { processSignal("+JSON.stringify(e)+', { analytics, signals }); } catch(err) { console.error("Process signal failed.", err); }',i=[a,s,c,l,f].join("\n"),t.n=2,this.jsSandbox.run(i,o);case 2:return u=r.getCalls(),t.a(2,u)}},t,this)})),function(e,n){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.jsSandbox.destroy()}}]);var t}(),an=function(t,e){var n=globalThis,r=n.processSignal;if(void 0!==r){var o=new Xe,i=new ye(e),u=n.analytics;if(u instanceof Xe)throw new Error("Invariant: analytics variable was not properly restored on the previous execution. This indicates a concurrency bug");var a=n.signals;try{n.analytics=o,n.signals=i,r(t,{analytics:o,signals:i})}finally{n.analytics=u,n.signals=a}return o.getCalls()}rn()},sn=function(){return $e(function t(e){Ue(this,t),tn(this,"htmlScriptLoaded",void 0),v.debug("Initializing global scope sandbox"),this.htmlScriptLoaded=me(e.edgeFnDownloadURL)},[{key:"execute",value:(t=Je(qe().m(function t(e,n){return qe().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.htmlScriptLoaded;case 1:return t.a(2,an(e,n))}},t,this)})),function(e,n){return t.apply(this,arguments)})},{key:"destroy",value:function(){}}]);var t}(),cn=function(){return $e(function t(){Ue(this,t)},[{key:"execute",value:function(t,e){return Promise.resolve(void 0)}},{key:"destroy",value:function(){}}])}();function ln(t){return ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ln(t)}function fn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return pn(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(pn(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,pn(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,pn(f,"constructor",c),pn(c,"constructor",s),s.displayName="GeneratorFunction",pn(c,o,"GeneratorFunction"),pn(f),pn(f,o,"Generator"),pn(f,r,function(){return this}),pn(f,"toString",function(){return"[object Generator]"}),(fn=function(){return{w:i,m:p}})()}function pn(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}pn=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){pn(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},pn(t,e,n,r)}function dn(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function yn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vn(r.key),r)}}function hn(t,e,n){return(e=vn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vn(t){var e=function(t,e){if("object"!=ln(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ln(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ln(e)?e:e+""}var bn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),hn(this,"processor",void 0),hn(this,"buffer",void 0)},e=[{key:"load",value:function(t){this.buffer=t.buffer;var e,n=t.unstableGlobalSettings.sandbox,r=function(t,e){if(!t||!e)return e;var n,r;n=e,r="https://".concat(t),/^https?:\/\//.test(r)||(r="https://"+r),n.replace(/^(https?:\/\/)?([^/]+)(\/.*)?$/,function(t,e,n,o){return"".concat(r).concat(o||"")})}(n.functionHost,n.edgeFnDownloadURL);r?"iframe"===n.sandboxStrategy||n.processSignal?(v.debug("Initializing sandbox: iframe"),e=new un(new on({processSignal:n.processSignal,edgeFnDownloadURL:r}))):(v.debug("Initializing sandbox: global scope"),e=new sn({edgeFnDownloadURL:r})):(console.warn("No processSignal function found. Have you written a processSignal function on app.segment.com?"),v.debug("Initializing sandbox: noop"),e=new cn),this.processor=new ee(t.analyticsInstance,e)}},{key:"process",value:(r=fn().m(function t(e){var n,r,o;return fn().w(function(t){for(;;)switch(t.n){case 0:return n=this.processor,r=e,t.n=1,this.buffer.getAll();case 1:return o=t.v,t.a(2,n.process.call(n,r,o))}},t,this)}),o=function(){var t=this,e=arguments;return new Promise(function(n,o){var i=r.apply(t,e);function u(t){dn(i,n,o,u,a,"next",t)}function a(t){dn(i,n,o,u,a,"throw",t)}u(void 0)})},function(t){return o.apply(this,arguments)})}],e&&yn(t.prototype,e),n&&yn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}(),mn=function(t){var e=t.replace("www.","").split("."),n=2;return["co","com","org","eu"].includes(e[e.length-2])&&(n=3),e.slice(-n).join(".")},gn=function(t){return t instanceof Headers?t:new Headers(t)},wn=function(t,e){if(!t)return!1;var n=gn(t);return e.some(function(t){var e;return null===(e=n.get("content-type"))||void 0===e?void 0:e.includes(t)})},Sn=function(t){return wn(t,["application/json","application/ld+json","text/json"])},On=function(t){return t>=200&&t<300},jn=function(t){try{return JSON.parse(t)}catch(e){return t}},Pn=function(t){return"string"==typeof t?t:"url"in t?t.url:t.toString()},kn=function(){return Math.random().toString(36).substring(3)};function xn(t){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xn(t)}function _n(t){return function(t){if(Array.isArray(t))return In(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return In(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?In(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function En(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ln(r.key),r)}}function Tn(t,e,n){return e&&En(t.prototype,e),n&&En(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function An(t,e,n){return(e=Ln(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ln(t){var e=function(t,e){if("object"!=xn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=xn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xn(e)?e:e+""}var Fn=Tn(function t(e){var n=e.networkSignalsAllowList,r=e.networkSignalsDisallowList,o=e.networkSignalsAllowSameDomain;Cn(this,t),An(this,"networkSignalsAllowSameDomain",void 0),An(this,"networkSignalsFilterList",void 0),this.networkSignalsAllowSameDomain=null==o||o,this.networkSignalsFilterList=new Gn(n,r)}),Mn=function(){return Tn(function t(e){Cn(this,t),An(this,"regexes",void 0),this.regexes=e},[{key:"combinedRegex",get:function(){return new RegExp(this.regexes.map(function(t){return"string"==typeof(e=t)?new RegExp(e):e;var e}).map(function(t){return t.source}).join("|"))}},{key:"test",value:function(t){return!!this.regexes.length&&this.combinedRegex.test(t)}},{key:"add",value:function(){var t;(t=this.regexes).push.apply(t,arguments)}},{key:"addURLLike",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n.map(function(e){return t.urlToRegex(e)}).filter(function(t){return Boolean(t)});this.add.apply(this,_n(o))}},{key:"urlToRegex",value:function(t){var e=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");try{return new RegExp(e)}catch(t){console.error("Invalid regex: ".concat(e),t)}}}])}(),Gn=function(){return Tn(function t(e,n){Cn(this,t),An(this,"allowed",void 0),An(this,"disallowed",void 0),An(this,"disallowedDefaults",void 0),this.allowed=new Mn(e||[]),this.disallowed=new Mn(n||[]),this.disallowedDefaults=new Mn(["api.segment.io","signals.segment.io","cdn.segment","webpack","hot-update","@vite/client","@vite/env","_hmr","-hmr","react-refresh","livereload","browser-sync","esbuild"])},[{key:"isDisallowed",value:function(t){return this.disallowed.test(t)||this.disallowedDefaults.test(t)}},{key:"isAllowed",value:function(t){return this.allowed.test(t)}},{key:"getRegexes",value:function(){return{allowed:this.allowed.regexes.map(function(t){return t.toString()}),disallowed:this.disallowed.regexes.map(function(t){return t.toString()})}}}])}(),Dn=function(){return Tn(function t(e){Cn(this,t),An(this,"settings",void 0),this.settings=e},[{key:"isAllowed",value:function(t){var e=this.settings,n=e.networkSignalsFilterList,r=e.networkSignalsAllowSameDomain;if(n.isDisallowed(t))return!1;var o=n.isAllowed(t)||r&&function(t){if(!new RegExp("^(?:[a-z+]+:)?//","i").test(t))return!0;var e=new URL(t).hostname;return mn(e)===mn(window.location.hostname)}(t);return o}}])}(),Hn=function(){return Tn(function t(){Cn(this,t),An(this,"filter",void 0)},[{key:"load",value:function(t){this.filter=new Dn(t.unstableGlobalSettings.network)}},{key:"process",value:function(t){return"network"===t.type?this.filter.isAllowed(t.data.url)?t:null:t}}])}(),Nn=o(608),Rn=o(779);function Bn(t,e,n,r){var o,i=[t,e,n,r],u=(0,Rn.Qd)(t)?t.event:t;if(!u||!(0,Rn.Kg)(u))throw new Error("Event missing");var a=(0,Rn.Qd)(t)?null!==(o=t.properties)&&void 0!==o?o:{}:(0,Rn.Qd)(e)?e:{},s={};return(0,Rn.Tn)(n)||(s=null!=n?n:{}),(0,Rn.Qd)(t)&&!(0,Rn.Tn)(e)&&(s=null!=e?e:{}),[u,a,s,i.find(Rn.Tn)]}function Kn(t,e,n,r,o){var i,u,a=null,s=null,c=[t,e,n,r,o],l=c.filter(Rn.Kg);1===l.length?(0,Rn.Kg)(c[1])?(s=c[1],a=null):(s=l[0],a=null):2===l.length&&("string"==typeof c[0]&&(a=c[0]),"string"==typeof c[1]&&(s=c[1]));var f=c.find(Rn.Tn),p=c.filter(Rn.Qd);return 1===p.length?(0,Rn.Qd)(c[2])?(u={},i=c[2]):(0,Rn.Qd)(c[3])?(i={},u=c[3]):(i=p[0],u={}):2===p.length&&(i=p[0],u=p[1]),[a,s,null!=i?i:i={},null!=u?u:u={},f]}var Zn=function(t){return function(){for(var e,n,r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];for(var u={},a=["callback","options","traits","id"],s=0,c=o;s<c.length;s++){var l=c[s],f=a.pop();if("id"===f){if((0,Rn.Kg)(l)||(0,Rn.Et)(l)){u.id=l.toString();continue}if(null==l)continue;f=a.pop()}if("traits"!==f&&"options"!==f||null!=l&&!(0,Rn.Qd)(l)||(u[f]=l),(0,Rn.Tn)(l)){u.callback=l;break}}return[null!==(e=u.id)&&void 0!==e?e:t.id(),null!==(n=u.traits)&&void 0!==n?n:{},null!==(r=u.options)&&void 0!==r?r:{},u.callback]}};function Yn(t,e,n,r){(0,Rn.Et)(t)&&(t=t.toString()),(0,Rn.Et)(e)&&(e=e.toString());var o=[t,e,n,r],i=o.filter(Rn.Kg),u=i[0],a=void 0===u?t:u,s=i[1],c=void 0===s?null:s,l=o.filter(Rn.Qd)[0];return[a,c,void 0===l?{}:l,o.find(Rn.Tn)]}function Xn(){return"undefined"!=typeof window}function zn(){return!(!Xn()||window.navigator.onLine)}var qn=o(834),Wn=o(0);function Vn(t,e){return e=e||{},new Promise(function(n,r){var o=new XMLHttpRequest,i=[],u=[],a={},s=function(){return{ok:2==(o.status/100|0),statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:s,headers:{keys:function(){return i},entries:function(){return u},get:function(t){return a[t.toLowerCase()]},has:function(t){return t.toLowerCase()in a}}}};for(var c in o.open(e.method||"get",t,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(t,e,n){i.push(e=e.toLowerCase()),u.push([e,n]),a[e]=a[e]?a[e]+","+n:n}),n(s())},o.onerror=r,o.withCredentials="include"==e.credentials,e.headers)o.setRequestHeader(c,e.headers[c]);o.send(e.body||null)})}var Jn=function(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==o.g?o.g:null},Un=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Jn();return(n&&n.fetch||Vn).apply(void 0,t)},Qn="1.81.1",$n="npm";function tr(){return $n}var er="api.segment.io/v1";function nr(t){console.error("Error sending segment performance metrics",t)}var rr,or=function(){function t(t){var e,n,r,o,i,u=this;if(this.host=null!==(e=null==t?void 0:t.host)&&void 0!==e?e:er,this.sampleRate=null!==(n=null==t?void 0:t.sampleRate)&&void 0!==n?n:1,this.flushTimer=null!==(r=null==t?void 0:t.flushTimer)&&void 0!==r?r:3e4,this.maxQueueSize=null!==(o=null==t?void 0:t.maxQueueSize)&&void 0!==o?o:20,this.protocol=null!==(i=null==t?void 0:t.protocol)&&void 0!==i?i:"https",this.queue=[],this.sampleRate>0){var a=!1,s=function(){a||(a=!0,u.flush().catch(nr),a=!1,setTimeout(s,u.flushTimer))};s()}}return t.prototype.increment=function(t,e){if(t.includes("analytics_js.")&&0!==e.length&&!(Math.random()>this.sampleRate||this.queue.length>=this.maxQueueSize)){var n=function(t,e,n){var r=e.reduce(function(t,e){var n=e.split(":"),r=n[0],o=n[1];return t[r]=o,t},{});return{type:"Counter",metric:t,value:1,tags:(0,Nn.Cl)((0,Nn.Cl)({},r),{library:"analytics.js",library_version:"web"===n?"next-".concat(Qn):"npm:next-".concat(Qn)})}}(t,e,tr());this.queue.push(n),t.includes("error")&&this.flush().catch(nr)}},t.prototype.flush=function(){return(0,Nn.sH)(this,void 0,void 0,function(){var t=this;return(0,Nn.YH)(this,function(e){switch(e.label){case 0:return this.queue.length<=0?[2]:[4,this.send().catch(function(e){nr(e),t.sampleRate=0})];case 1:return e.sent(),[2]}})})},t.prototype.send=function(){return(0,Nn.sH)(this,void 0,void 0,function(){var t,e,n;return(0,Nn.YH)(this,function(r){return t={series:this.queue},this.queue=[],e={"Content-Type":"text/plain"},n="".concat(this.protocol,"://").concat(this.host,"/m"),[2,Un(n,{headers:e,body:JSON.stringify(t),method:"POST"})]})})},t}(),ir=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Nn.C6)(e,t),e.initRemoteMetrics=function(t){rr=new or(t)},e.prototype.increment=function(e,n,r){t.prototype.increment.call(this,e,n,r),null==rr||rr.increment(e,null!=r?r:[])},e}(Wn.p),ur=function(t){function e(e,n){return t.call(this,e,n,new ir)||this}return(0,Nn.C6)(e,t),e.system=function(){return new this({type:"track",event:"system"})},e}(qn.j),ar=o(190);function sr(t,e,n,r){return(0,Nn.sH)(this,void 0,void 0,function(){var o,i;return(0,Nn.YH)(this,function(u){switch(u.label){case 0:return n.emit("dispatch_start",t),o=Date.now(),e.isEmpty()?[4,e.dispatchSingle(t)]:[3,2];case 1:return i=u.sent(),[3,4];case 2:return[4,e.dispatch(t)];case 3:i=u.sent(),u.label=4;case 4:return(null==r?void 0:r.callback)?[4,(0,ar.w_)(i,r.callback,(a=o,s=r.timeout,c=Date.now()-a,Math.max((null!=s?s:300)-c,0)))]:[3,6];case 5:i=u.sent(),u.label=6;case 6:return(null==r?void 0:r.debug)&&i.flush(),[2,i]}var a,s,c})})}var cr=function(){function t(t){var e;this.callbacks={},this.warned=!1,this.maxListeners=null!==(e=null==t?void 0:t.maxListeners)&&void 0!==e?e:10}return t.prototype.warnIfPossibleMemoryLeak=function(t){this.warned||this.maxListeners&&this.callbacks[t].length>this.maxListeners&&(console.warn("Event Emitter: Possible memory leak detected; ".concat(String(t)," has exceeded ").concat(this.maxListeners," listeners.")),this.warned=!0)},t.prototype.on=function(t,e){return this.callbacks[t]?(this.callbacks[t].push(e),this.warnIfPossibleMemoryLeak(t)):this.callbacks[t]=[e],this},t.prototype.once=function(t,e){var n=this,r=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];n.off(t,r),e.apply(n,o)};return this.on(t,r),this},t.prototype.off=function(t,e){var n,r=(null!==(n=this.callbacks[t])&&void 0!==n?n:[]).filter(function(t){return t!==e});return this.callbacks[t]=r,this},t.prototype.emit=function(t){for(var e,n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return(null!==(e=this.callbacks[t])&&void 0!==e?e:[]).forEach(function(t){t.apply(n,r)}),this},t}(),lr=o(659);var fr=function(t,e,n,r,o,i){return{__t:"bpc",c:e,p:r,u:t,s:n,t:o,r:i}},pr=Object.keys(fr("","","","","",""));function dr(t){if(e=t,"object"!==Object.prototype.toString.call(e).slice(8,-1).toLowerCase())return!1;var e;if("bpc"!==t.__t)return!1;for(var n in t)if(!pr.includes(n))return!1;return!0}var yr=function(t){var e,n,r=t.c,o=t.p,i=t.s,u=t.u,a=t.r,s=t.t,c=r?function(t){try{return new URL(t).pathname}catch(e){return"/"===t[0]?t:"/"+t}}(r):o,l=r?function(t,e){return t.indexOf("?")>-1?t:t+e}(r,i):-1===(n=(e=u).indexOf("#"))?e:e.slice(0,n);return{path:c,referrer:a,search:i,title:s,url:l}},hr=function(){var t=document.querySelector("link[rel='canonical']");return fr(location.href,t&&t.getAttribute("href")||void 0,location.search,location.pathname,document.title,document.referrer)},vr=function(t,e){void 0===e&&(e=yr(hr()));var n,r,o,i=t.context;"page"===t.type&&(n=t.properties&&(r=t.properties,o=Object.keys(e),Object.assign.apply(Object,(0,Nn.fX)([{}],o.map(function(t){var e;if(r&&Object.prototype.hasOwnProperty.call(r,t))return(e={})[t]=r[t],e}),!1))),t.properties=(0,Nn.Cl)((0,Nn.Cl)((0,Nn.Cl)({},e),t.properties),t.name?{name:t.name}:{})),i.page=(0,Nn.Cl)((0,Nn.Cl)((0,Nn.Cl)({},e),n),i.page)},br=o(435),mr=function(t){function e(e,n){var r=t.call(this,"".concat(e," ").concat(n))||this;return r.field=e,r}return(0,Nn.C6)(e,t),e}(Error);function gr(t){return gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gr(t)}var wr="is not a string",Sr="is not an object",Or="is nil";function jr(t){!function(t){if(!(0,Rn.t2)(t))throw new mr("Event",Or);if("object"!==gr(t))throw new mr("Event",Sr)}(t),function(t){if(!(0,Rn.Kg)(t.type))throw new mr(".type",wr)}(t),function(t){if(!(0,Rn.Kg)(t.messageId))throw new mr(".messageId",wr)}(t),"track"===t.type&&(function(t){if(!(0,Rn.Kg)(t.event))throw new mr(".event",wr)}(t),function(t){if(!(0,Rn.Qd)(t.properties))throw new mr(".properties",Sr)}(t)),["group","identify"].includes(t.type)&&function(t){if(!(0,Rn.Qd)(t.traits))throw new mr(".traits",Sr)}(t)}var Pr=function(t){var e,n;this.settings=t,this.createMessageId=t.createMessageId,this.onEventMethodCall=null!==(e=t.onEventMethodCall)&&void 0!==e?e:function(){},this.onFinishedEvent=null!==(n=t.onFinishedEvent)&&void 0!==n?n:function(){}},kr=function(){function t(t){this.settings=new Pr(t)}return t.prototype.track=function(t,e,n,r){return this.settings.onEventMethodCall({type:"track",options:n}),this.normalize((0,Nn.Cl)((0,Nn.Cl)({},this.baseEvent()),{event:t,type:"track",properties:null!=e?e:{},options:(0,Nn.Cl)({},n),integrations:(0,Nn.Cl)({},r)}))},t.prototype.page=function(t,e,n,r,o){var i;this.settings.onEventMethodCall({type:"page",options:r});var u={type:"page",properties:(0,Nn.Cl)({},n),options:(0,Nn.Cl)({},r),integrations:(0,Nn.Cl)({},o)};return null!==t&&(u.category=t,u.properties=null!==(i=u.properties)&&void 0!==i?i:{},u.properties.category=t),null!==e&&(u.name=e),this.normalize((0,Nn.Cl)((0,Nn.Cl)({},this.baseEvent()),u))},t.prototype.screen=function(t,e,n,r,o){this.settings.onEventMethodCall({type:"screen",options:r});var i={type:"screen",properties:(0,Nn.Cl)({},n),options:(0,Nn.Cl)({},r),integrations:(0,Nn.Cl)({},o)};return null!==t&&(i.category=t),null!==e&&(i.name=e),this.normalize((0,Nn.Cl)((0,Nn.Cl)({},this.baseEvent()),i))},t.prototype.identify=function(t,e,n,r){return this.settings.onEventMethodCall({type:"identify",options:n}),this.normalize((0,Nn.Cl)((0,Nn.Cl)({},this.baseEvent()),{type:"identify",userId:t,traits:null!=e?e:{},options:(0,Nn.Cl)({},n),integrations:r}))},t.prototype.group=function(t,e,n,r){return this.settings.onEventMethodCall({type:"group",options:n}),this.normalize((0,Nn.Cl)((0,Nn.Cl)({},this.baseEvent()),{type:"group",traits:null!=e?e:{},options:(0,Nn.Cl)({},n),integrations:(0,Nn.Cl)({},r),groupId:t}))},t.prototype.alias=function(t,e,n,r){this.settings.onEventMethodCall({type:"alias",options:n});var o={userId:t,type:"alias",options:(0,Nn.Cl)({},n),integrations:(0,Nn.Cl)({},r)};return null!==e&&(o.previousId=e),void 0===t?this.normalize((0,Nn.Cl)((0,Nn.Cl)({},o),this.baseEvent())):this.normalize((0,Nn.Cl)((0,Nn.Cl)({},this.baseEvent()),o))},t.prototype.baseEvent=function(){return{integrations:{},options:{}}},t.prototype.context=function(t){var e,n=["userId","anonymousId","timestamp","messageId"];delete t.integrations;var r=Object.keys(t),o=null!==(e=t.context)&&void 0!==e?e:{},i={};return r.forEach(function(e){"context"!==e&&(n.includes(e)?(0,br.J)(i,e,t[e]):(0,br.J)(o,e,t[e]))}),[o,i]},t.prototype.normalize=function(t){var e,n,r,o,i=Object.keys(null!==(e=t.integrations)&&void 0!==e?e:{}).reduce(function(e,n){var r,o;return(0,Nn.Cl)((0,Nn.Cl)({},e),((r={})[n]=Boolean(null===(o=t.integrations)||void 0===o?void 0:o[n]),r))},{});t.options=(r=t.options||{},o=function(t,e){return void 0!==e},Object.keys(r).filter(function(t){return o(t,r[t])}).reduce(function(t,e){return t[e]=r[e],t},{}));var u=(0,Nn.Cl)((0,Nn.Cl)({},i),null===(n=t.options)||void 0===n?void 0:n.integrations),a=t.options?this.context(t.options):[],s=a[0],c=a[1],l=t.options,f=(0,Nn.Tt)(t,["options"]),p=(0,Nn.Cl)((0,Nn.Cl)((0,Nn.Cl)((0,Nn.Cl)({timestamp:new Date},f),{context:s,integrations:u}),c),{messageId:l.messageId||this.settings.createMessageId()});return this.settings.onFinishedEvent(p),jr(p),p},t}(),xr=function(t){function e(e){var n=t.call(this,{createMessageId:function(){return"ajs-next-".concat(Date.now(),"-").concat((0,lr.v4)())},onEventMethodCall:function(t){var e=t.options;n.maybeUpdateAnonId(e)},onFinishedEvent:function(t){return n.addIdentity(t),t}})||this;return n.user=e,n}return(0,Nn.C6)(e,t),e.prototype.maybeUpdateAnonId=function(t){(null==t?void 0:t.anonymousId)&&this.user.anonymousId(t.anonymousId)},e.prototype.addIdentity=function(t){this.user.id()&&(t.userId=this.user.id()),this.user.anonymousId()&&(t.anonymousId=this.user.anonymousId())},e.prototype.track=function(e,n,r,o,i){var u=t.prototype.track.call(this,e,n,r,o);return vr(u,i),u},e.prototype.page=function(e,n,r,o,i,u){var a=t.prototype.page.call(this,e,n,r,o,i);return vr(a,u),a},e.prototype.screen=function(e,n,r,o,i,u){var a=t.prototype.screen.call(this,e,n,r,o,i);return vr(a,u),a},e.prototype.identify=function(e,n,r,o,i){var u=t.prototype.identify.call(this,e,n,r,o);return vr(u,i),u},e.prototype.group=function(e,n,r,o,i){var u=t.prototype.group.call(this,e,n,r,o);return vr(u,i),u},e.prototype.alias=function(e,n,r,o,i){var u=t.prototype.alias.call(this,e,n,r,o);return vr(u,i),u},e}(kr),_r=function(t){return"addMiddleware"in t&&"destination"===t.type};var Ir="onRemoveFromFuture",Er=function(t){function e(e,n,r){var o=t.call(this)||this;return o.future=[],o.maxAttempts=e,o.queue=n,o.seen=null!=r?r:{},o}return(0,Nn.C6)(e,t),e.prototype.push=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.map(function(e){return!(t.updateAttempts(e)>t.maxAttempts||t.includes(e))&&(t.queue.push(e),!0)});return this.queue=this.queue.sort(function(e,n){return t.getAttempts(e)-t.getAttempts(n)}),r},e.prototype.pushWithBackoff=function(t,e){var n=this;if(void 0===e&&(e=0),0==e&&0===this.getAttempts(t))return this.push(t)[0];var r=this.updateAttempts(t);if(r>this.maxAttempts||this.includes(t))return!1;var o=function(t){var e=Math.random()+1,n=t.minTimeout,r=void 0===n?500:n,o=t.factor,i=void 0===o?2:o,u=t.attempt,a=t.maxTimeout,s=void 0===a?1/0:a;return Math.min(e*r*Math.pow(i,u),s)}({attempt:r-1});return e>0&&o<e&&(o=e),setTimeout(function(){n.queue.push(t),n.future=n.future.filter(function(e){return e.id!==t.id}),n.emit(Ir)},o),this.future.push(t),!0},e.prototype.getAttempts=function(t){var e;return null!==(e=this.seen[t.id])&&void 0!==e?e:0},e.prototype.updateAttempts=function(t){return this.seen[t.id]=this.getAttempts(t)+1,this.getAttempts(t)},e.prototype.includes=function(t){return this.queue.includes(t)||this.future.includes(t)||Boolean(this.queue.find(function(e){return e.id===t.id}))||Boolean(this.future.find(function(e){return e.id===t.id}))},e.prototype.pop=function(){return this.queue.shift()},Object.defineProperty(e.prototype,"length",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"todo",{get:function(){return this.queue.length+this.future.length},enumerable:!1,configurable:!0}),e}(cr),Tr={getItem:function(){},setItem:function(){},removeItem:function(){}};try{Tr=Xn()&&window.localStorage?window.localStorage:Tr}catch(t){console.warn("Unable to access localStorage",t)}function Cr(t){var e=Tr.getItem(t);return(e?JSON.parse(e):[]).map(function(t){return new ur(t.event,t.id)})}function Ar(t){var e=Tr.getItem(t);return e?JSON.parse(e):{}}function Lr(t){Tr.removeItem(t)}function Fr(t,e,n){void 0===n&&(n=0);var r="persisted-queue:v1:".concat(t,":lock"),o=Tr.getItem(r),i=o?JSON.parse(o):null,u=null===i||function(t){return(new Date).getTime()>t}(i);if(u)return Tr.setItem(r,JSON.stringify((new Date).getTime()+50)),e(),void Tr.removeItem(r);!u&&n<3?setTimeout(function(){Fr(t,e,n+1)},50):console.error("Unable to retrieve lock")}var Mr=function(t){function e(e,n){var r=t.call(this,e,[])||this,o="persisted-queue:v1:".concat(n,":items"),i="persisted-queue:v1:".concat(n,":seen"),u=[],a={};return Fr(n,function(){try{u=Cr(o),a=Ar(i),Lr(o),Lr(i),r.queue=(0,Nn.fX)((0,Nn.fX)([],u,!0),r.queue,!0),r.seen=(0,Nn.Cl)((0,Nn.Cl)({},a),r.seen)}catch(t){console.error(t)}}),window.addEventListener("pagehide",function(){if(r.todo>0){var t=(0,Nn.fX)((0,Nn.fX)([],r.queue,!0),r.future,!0);try{Fr(n,function(){!function(t,e){var n=Cr(t),r=(0,Nn.fX)((0,Nn.fX)([],e,!0),n,!0).reduce(function(t,e){var n;return(0,Nn.Cl)((0,Nn.Cl)({},t),((n={})[e.id]=e,n))},{});Tr.setItem(t,JSON.stringify(Object.values(r)))}(o,t),function(t,e){var n=Ar(t);Tr.setItem(t,JSON.stringify((0,Nn.Cl)((0,Nn.Cl)({},n),e)))}(i,r.seen)})}catch(t){console.error(t)}}}),r}return(0,Nn.C6)(e,t),e}(Er);function Gr(t){return Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gr(t)}var Dr=function(){var t,e,n=0;return{done:function(){return t},run:function(r){var o,i=r();return"object"===Gr(o=i)&&null!==o&&"then"in o&&"function"==typeof o.then&&(1===++n&&(t=new Promise(function(t){return e=t})),i.finally(function(){return 0===--n&&e()})),i}}};function Hr(t,e){t.log("debug","plugin",{plugin:e.name});var n=(new Date).getTime(),r=e[t.event.type];return void 0===r?Promise.resolve(t):function(t){return(0,Nn.sH)(this,void 0,void 0,function(){var e;return(0,Nn.YH)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t()];case 1:return[2,n.sent()];case 2:return e=n.sent(),[2,Promise.reject(e)];case 3:return[2]}})})}(function(){return r.apply(e,[t])}).then(function(t){var r=(new Date).getTime()-n;return t.stats.gauge("plugin_time",r,["plugin:".concat(e.name)]),t}).catch(function(n){if(n instanceof qn.d&&"middleware_cancellation"===n.type)throw n;return n instanceof qn.d?(t.log("warn",n.type,{plugin:e.name,error:n}),n):(t.log("error","plugin Error",{plugin:e.name,error:n}),t.stats.increment("plugin_error",1,["plugin:".concat(e.name)]),n)})}function Nr(t,e){return Hr(t,e).then(function(e){if(e instanceof qn.j)return e;t.log("debug","Context canceled"),t.stats.increment("context_canceled"),t.cancel(e)})}var Rr=function(t){function e(e){return t.call(this,"string"==typeof e?new Mr(4,e):e)||this}return(0,Nn.C6)(e,t),e.prototype.flush=function(){return(0,Nn.sH)(this,void 0,void 0,function(){return(0,Nn.YH)(this,function(e){return zn()?[2,[]]:[2,t.prototype.flush.call(this)]})})},e}(function(t){function e(e){var n=t.call(this)||this;return n.criticalTasks=Dr(),n.plugins=[],n.failedInitializations=[],n.flushing=!1,n.queue=e,n.queue.on(Ir,function(){n.scheduleFlush(0)}),n}return(0,Nn.C6)(e,t),e.prototype.register=function(t,e,n){return(0,Nn.sH)(this,void 0,void 0,function(){var r,o,i=this;return(0,Nn.YH)(this,function(u){switch(u.label){case 0:return this.plugins.push(e),r=function(n){i.failedInitializations.push(e.name),i.emit("initialization_failure",e),console.warn(e.name,n),t.log("warn","Failed to load destination",{plugin:e.name,error:n}),i.plugins=i.plugins.filter(function(t){return t!==e})},"destination"!==e.type||"Segment.io"===e.name?[3,1]:(e.load(t,n).catch(r),[3,4]);case 1:return u.trys.push([1,3,,4]),[4,e.load(t,n)];case 2:return u.sent(),[3,4];case 3:return o=u.sent(),r(o),[3,4];case 4:return[2]}})})},e.prototype.deregister=function(t,e,n){return(0,Nn.sH)(this,void 0,void 0,function(){var r;return(0,Nn.YH)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),e.unload?[4,Promise.resolve(e.unload(t,n))]:[3,2];case 1:o.sent(),o.label=2;case 2:return this.plugins=this.plugins.filter(function(t){return t.name!==e.name}),[3,4];case 3:return r=o.sent(),t.log("warn","Failed to unload destination",{plugin:e.name,error:r}),[3,4];case 4:return[2]}})})},e.prototype.dispatch=function(t){return(0,Nn.sH)(this,void 0,void 0,function(){var e;return(0,Nn.YH)(this,function(n){return t.log("debug","Dispatching"),t.stats.increment("message_dispatched"),this.queue.push(t),e=this.subscribeToDelivery(t),this.scheduleFlush(0),[2,e]})})},e.prototype.subscribeToDelivery=function(t){return(0,Nn.sH)(this,void 0,void 0,function(){var e=this;return(0,Nn.YH)(this,function(n){return[2,new Promise(function(n){var r=function(o,i){o.isSame(t)&&(e.off("flush",r),n(o))};e.on("flush",r)})]})})},e.prototype.dispatchSingle=function(t){return(0,Nn.sH)(this,void 0,void 0,function(){var e=this;return(0,Nn.YH)(this,function(n){return t.log("debug","Dispatching"),t.stats.increment("message_dispatched"),this.queue.updateAttempts(t),t.attempts=1,[2,this.deliver(t).catch(function(n){return e.enqueuRetry(n,t)?e.subscribeToDelivery(t):(t.setFailedDelivery({reason:n}),t)})]})})},e.prototype.isEmpty=function(){return 0===this.queue.length},e.prototype.scheduleFlush=function(t){var e=this;void 0===t&&(t=500),this.flushing||(this.flushing=!0,setTimeout(function(){e.flush().then(function(){setTimeout(function(){e.flushing=!1,e.queue.length&&e.scheduleFlush(0)},0)})},t))},e.prototype.deliver=function(t){return(0,Nn.sH)(this,void 0,void 0,function(){var e,n,r,o;return(0,Nn.YH)(this,function(i){switch(i.label){case 0:return[4,this.criticalTasks.done()];case 1:i.sent(),e=Date.now(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.flushOne(t)];case 3:return t=i.sent(),n=Date.now()-e,this.emit("delivery_success",t),t.stats.gauge("delivered",n),t.log("debug","Delivered",t.event),[2,t];case 4:throw r=i.sent(),o=r,t.log("error","Failed to deliver",o),this.emit("delivery_failure",t,o),t.stats.increment("delivery_failed"),r;case 5:return[2]}})})},e.prototype.enqueuRetry=function(t,e){return!(t instanceof qn.d&&!t.retry)&&this.queue.pushWithBackoff(e)},e.prototype.flush=function(){return(0,Nn.sH)(this,void 0,void 0,function(){var t,e;return(0,Nn.YH)(this,function(n){switch(n.label){case 0:if(0===this.queue.length)return[2,[]];if(!(t=this.queue.pop()))return[2,[]];t.attempts=this.queue.getAttempts(t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.deliver(t)];case 2:return t=n.sent(),this.emit("flush",t,!0),[3,4];case 3:return e=n.sent(),this.enqueuRetry(e,t)||(t.setFailedDelivery({reason:e}),this.emit("flush",t,!1)),[2,[]];case 4:return[2,[t]]}})})},e.prototype.isReady=function(){return!0},e.prototype.availableExtensions=function(t){var e,n,r=this.plugins.filter(function(e){var n,r,o;if("destination"!==e.type&&"Segment.io"!==e.name)return!0;var i=void 0;return null===(n=e.alternativeNames)||void 0===n||n.forEach(function(e){void 0!==t[e]&&(i=t[e])}),null!==(o=null!==(r=t[e.name])&&void 0!==r?r:i)&&void 0!==o?o:!1!==("Segment.io"===e.name||t.All)}),o=(e="type",n={},r.forEach(function(t){var r,o=void 0;if("string"==typeof e){var i=t[e];o="string"!=typeof i?JSON.stringify(i):i}else e instanceof Function&&(o=e(t));void 0!==o&&(n[o]=(0,Nn.fX)((0,Nn.fX)([],null!==(r=n[o])&&void 0!==r?r:[],!0),[t],!1))}),n),i=o.before,u=void 0===i?[]:i,a=o.enrichment,s=void 0===a?[]:a,c=o.destination,l=void 0===c?[]:c,f=o.after;return{before:u,enrichment:s,destinations:l,after:void 0===f?[]:f}},e.prototype.flushOne=function(t){var e,n;return(0,Nn.sH)(this,void 0,void 0,function(){var r,o,i,u,a,s,c,l,f,p,d,y,h,v;return(0,Nn.YH)(this,function(b){switch(b.label){case 0:if(!this.isReady())throw new Error("Not ready");t.attempts>1&&this.emit("delivery_retry",t),r=this.availableExtensions(null!==(e=t.event.integrations)&&void 0!==e?e:{}),o=r.before,i=r.enrichment,u=0,a=o,b.label=1;case 1:return u<a.length?(s=a[u],[4,Nr(t,s)]):[3,4];case 2:(p=b.sent())instanceof qn.j&&(t=p),this.emit("message_enriched",t,s),b.label=3;case 3:return u++,[3,1];case 4:c=0,l=i,b.label=5;case 5:return c<l.length?(f=l[c],[4,Hr(t,f)]):[3,8];case 6:(p=b.sent())instanceof qn.j&&(t=p),this.emit("message_enriched",t,f),b.label=7;case 7:return c++,[3,5];case 8:return d=this.availableExtensions(null!==(n=t.event.integrations)&&void 0!==n?n:{}),y=d.destinations,h=d.after,[4,new Promise(function(e,n){setTimeout(function(){var r=y.map(function(e){return Hr(t,e)});Promise.all(r).then(e).catch(n)},0)})];case 9:return b.sent(),t.stats.increment("message_delivered"),this.emit("message_delivered",t),v=h.map(function(e){return Hr(t,e)}),[4,Promise.all(v)];case 10:return b.sent(),[2,t]}})})},e}(cr));function Br(t){for(var e=t.constructor.prototype,n=0,r=Object.getOwnPropertyNames(e);n<r.length;n++){var o=r[n];if("constructor"!==o){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype,o);i&&"function"==typeof i.value&&(t[o]=t[o].bind(t))}}return t}var Kr={Cookie:"cookie",LocalStorage:"localStorage",Memory:"memory"},Zr=function(t,e,n,r){console.warn("".concat(t.constructor.name,": Can't ").concat(e,' key "').concat(n,'" | Err: ').concat(r))},Yr=function(){function t(t){this.stores=t}return t.prototype.get=function(t){for(var e=null,n=0,r=this.stores;n<r.length;n++){var o=r[n];try{if(null!=(e=o.get(t)))return e}catch(e){Zr(o,"get",t,e)}}return null},t.prototype.set=function(t,e){this.stores.forEach(function(n){try{n.set(t,e)}catch(e){Zr(n,"set",t,e)}})},t.prototype.clear=function(t){this.stores.forEach(function(e){try{e.remove(t)}catch(n){Zr(e,"remove",t,n)}})},t.prototype.getAndSync=function(t){var e=this.get(t),n="number"==typeof e?e.toString():e;return this.set(t,n),n},t}(),Xr=function(){function t(){this.cache={}}return t.prototype.get=function(t){var e;return null!==(e=this.cache[t])&&void 0!==e?e:null},t.prototype.set=function(t,e){this.cache[t]=e},t.prototype.remove=function(t){delete this.cache[t]},t}();function zr(t){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zr(t)}function qr(t){return t&&t.stores&&Array.isArray(t.stores)&&t.stores.every(function(t){return Object.values(Kr).includes(t)})}function Wr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}var Vr=function t(e,n){function r(t,r,o){if("undefined"!=typeof document){"number"==typeof(o=Wr({},n,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var u in o)o[u]&&(i+="; "+u,!0!==o[u]&&(i+="="+o[u].split(";")[0]));return document.cookie=t+"="+e.write(r,t)+i}}return Object.create({set:r,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var i=n[o].split("="),u=i.slice(1).join("=");try{var a=decodeURIComponent(i[0]);if(r[a]=e.read(u,a),t===a)break}catch(t){}}return t?r[t]:r}},remove:function(t,e){r(t,"",Wr({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,Wr({},this.attributes,e))},withConverter:function(e){return t(Wr({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),Jr=Vr;function Ur(t){var e=function(t){try{return new URL(t)}catch(t){return}}(t);if(e)for(var n=function(t){var e=t.hostname.split("."),n=e[e.length-1],r=[];if(4===e.length&&parseInt(n,10)>0)return r;if(e.length<=1)return r;for(var o=e.length-2;o>=0;--o)r.push(e.slice(o).join("."));return r}(e),r=0;r<n.length;++r){var o="__tld__",i=n[r],u={domain:"."+i};try{if(Jr.set(o,"1",u),Jr.get(o))return Jr.remove(o,u),i}catch(t){return}}}var Qr=function(){function t(e){void 0===e&&(e=t.defaults),this.options=(0,Nn.Cl)((0,Nn.Cl)({},t.defaults),e)}return Object.defineProperty(t,"defaults",{get:function(){return{maxage:365,domain:Ur(window.location.href),path:"/",sameSite:"Lax"}},enumerable:!1,configurable:!0}),t.prototype.opts=function(){return{sameSite:this.options.sameSite,expires:this.options.maxage,domain:this.options.domain,path:this.options.path,secure:this.options.secure}},t.prototype.get=function(t){var e;try{var n=Jr.get(t);if(null==n)return null;try{return null!==(e=JSON.parse(n))&&void 0!==e?e:null}catch(t){return null!=n?n:null}}catch(t){return null}},t.prototype.set=function(t,e){"string"==typeof e?Jr.set(t,e,this.opts()):null===e?Jr.remove(t,this.opts()):Jr.set(t,JSON.stringify(e),this.opts())},t.prototype.remove=function(t){return Jr.remove(t,this.opts())},t}(),$r=function(){function t(){}return t.prototype.localStorageWarning=function(t,e){console.warn("Unable to access ".concat(t,", localStorage may be ").concat(e))},t.prototype.get=function(t){var e;try{var n=localStorage.getItem(t);if(null===n)return null;try{return null!==(e=JSON.parse(n))&&void 0!==e?e:null}catch(t){return null!=n?n:null}}catch(e){return this.localStorageWarning(t,"unavailable"),null}},t.prototype.set=function(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(e){this.localStorageWarning(t,"full")}},t.prototype.remove=function(t){try{return localStorage.removeItem(t)}catch(e){this.localStorageWarning(t,"unavailable")}},t}();function to(t){return t.map(function(t){var e,n;switch(!function(t){return"object"===zr(t)&&void 0!==t.name}(t)?e=t:(e=t.name,n=t.settings),e){case Kr.Cookie:return new Qr(n);case Kr.LocalStorage:return new $r;case Kr.Memory:return new Xr;default:throw new Error("Unknown Store Type: ".concat(t))}})}function eo(t,e){return t.map(function(t){return e&&t===Kr.Cookie?{name:t,settings:e}:t})}function no(t){return no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},no(t)}var ro={persist:!0,cookie:{key:"ajs_user_id",oldKey:"ajs_user"},localStorage:{key:"ajs_user_traits"}},oo=function(){function t(t,e){void 0===t&&(t=ro);var n,r,o,i,u=this;this.options={},this.id=function(t){if(u.options.disable)return null;var e=u.identityStore.getAndSync(u.idKey);void 0!==t&&(u.identityStore.set(u.idKey,t),t!==e&&null!==e&&null!==t&&u.anonymousId(null));var n=u.identityStore.getAndSync(u.idKey);if(n)return n;var r=u.legacyUserStore.get(ro.cookie.oldKey);return r?"object"===no(r)?r.id:r:null},this.anonymousId=function(t){var e,n;if(u.options.disable)return null;if(void 0===t){var r=null!==(e=u.identityStore.getAndSync(u.anonKey))&&void 0!==e?e:null===(n=u.legacySIO())||void 0===n?void 0:n[0];if(r)return r}return null===t?(u.identityStore.set(u.anonKey,null),u.identityStore.getAndSync(u.anonKey)):(u.identityStore.set(u.anonKey,null!=t?t:(0,lr.v4)()),u.identityStore.getAndSync(u.anonKey))},this.traits=function(t){var e;if(!u.options.disable)return null===t&&(t={}),t&&u.traitsStore.set(u.traitsKey,null!=t?t:{}),null!==(e=u.traitsStore.get(u.traitsKey))&&void 0!==e?e:{}},this.options=(0,Nn.Cl)((0,Nn.Cl)({},ro),t),this.cookieOptions=e,this.idKey=null!==(r=null===(n=t.cookie)||void 0===n?void 0:n.key)&&void 0!==r?r:ro.cookie.key,this.traitsKey=null!==(i=null===(o=t.localStorage)||void 0===o?void 0:o.key)&&void 0!==i?i:ro.localStorage.key,this.anonKey="ajs_anonymous_id",this.identityStore=this.createStorage(this.options,e),this.legacyUserStore=this.createStorage(this.options,e,function(t){return t===Kr.Cookie}),this.traitsStore=this.createStorage(this.options,e,function(t){return t!==Kr.Cookie});var a=this.legacyUserStore.get(ro.cookie.oldKey);a&&"object"===no(a)&&(a.id&&this.id(a.id),a.traits&&this.traits(a.traits)),Br(this)}return t.prototype.legacySIO=function(){var t=this.legacyUserStore.get("_sio");if(!t)return null;var e=t.split("----");return[e[0],e[1]]},t.prototype.identify=function(t,e){if(!this.options.disable){e=null!=e?e:{};var n=this.id();null!==n&&n!==t||(e=(0,Nn.Cl)((0,Nn.Cl)({},this.traits()),e)),t&&this.id(t),this.traits(e)}},t.prototype.logout=function(){this.anonymousId(null),this.id(null),this.traits({})},t.prototype.reset=function(){this.logout(),this.identityStore.clear(this.idKey),this.identityStore.clear(this.anonKey),this.traitsStore.clear(this.traitsKey)},t.prototype.load=function(){return new t(this.options,this.cookieOptions)},t.prototype.save=function(){return!0},t.prototype.createStorage=function(t,e,n){var r=[Kr.LocalStorage,Kr.Cookie,Kr.Memory];return t.disable?new Yr([]):t.persist?(void 0!==t.storage&&null!==t.storage&&qr(t.storage)&&(r=t.storage.stores),t.localStorageFallbackDisabled&&(r=r.filter(function(t){return t!==Kr.LocalStorage})),n&&(r=r.filter(n)),new Yr(to(eo(r,e)))):new Yr([new Xr])},t.defaults=ro,t}(),io={persist:!0,cookie:{key:"ajs_group_id"},localStorage:{key:"ajs_group_properties"}},uo=function(t){function e(e,n){void 0===e&&(e=io);var r=t.call(this,(0,Nn.Cl)((0,Nn.Cl)({},io),e),n)||this;return r.anonymousId=function(t){},Br(r),r}return(0,Nn.C6)(e,t),e}(oo),ao="analytics";function so(t){return so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},so(t)}var co=function(t,e,n){n.getAndRemove(t).forEach(function(t){ho(e,t).catch(console.error)})},lo=(co.bind(void 0,"on"),co.bind(void 0,"setAnonymousId"),function(t){if(fo(t)){var e=t.pop();return yr(e)}}),fo=function(t){return dr(t[t.length-1])},po=function(t,e,n,r){void 0===n&&(n=function(){}),void 0===r&&(r=console.error),this.method=t,this.resolve=n,this.reject=r,this.called=!1,this.args=e},yo=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._callMap={},this.add.apply(this,t)}return Object.defineProperty(t.prototype,"calls",{get:function(){return this._pushSnippetWindowBuffer(),this._callMap},set:function(t){this._callMap=t},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e;return null!==(e=this.calls[t])&&void 0!==e?e:[]},t.prototype.getAndRemove=function(t){var e=this.get(t);return this.calls[t]=[],e},t.prototype.add=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach(function(e){["track","screen","alias","group","page","identify"].includes(e.method)&&!fo(e.args)&&(e.args=(0,Nn.fX)((0,Nn.fX)([],e.args,!0),[hr()],!1)),t.calls[e.method]?t.calls[e.method].push(e):t.calls[e.method]=[e]})},t.prototype.clear=function(){this._pushSnippetWindowBuffer(),this.calls={}},t.prototype.toArray=function(){var t;return(t=[]).concat.apply(t,Object.values(this.calls))},t.prototype._pushSnippetWindowBuffer=function(){if("npm"!==tr()){var t=window[ao];if(Array.isArray(t)){var e=t.splice(0,t.length).map(function(t){var e=t[0],n=t.slice(1);return new po(e,n)});this.add.apply(this,e)}}},t}();function ho(t,e){return(0,Nn.sH)(this,void 0,void 0,function(){var n,r;return(0,Nn.YH)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),e.called?[2,void 0]:(e.called=!0,n=t[e.method].apply(t,e.args),"object"===so(i=n)&&null!==i&&"then"in i&&"function"==typeof i.then?[4,n]:[3,2]);case 1:o.sent(),o.label=2;case 2:return e.resolve(n),[3,4];case 3:return r=o.sent(),e.reject(r),[3,4];case 4:return[2]}var i})})}!function(){function t(t){var e=this;this.trackSubmit=this._createMethod("trackSubmit"),this.trackClick=this._createMethod("trackClick"),this.trackLink=this._createMethod("trackLink"),this.pageView=this._createMethod("pageview"),this.identify=this._createMethod("identify"),this.reset=this._createMethod("reset"),this.group=this._createMethod("group"),this.track=this._createMethod("track"),this.ready=this._createMethod("ready"),this.alias=this._createMethod("alias"),this.debug=this._createChainableMethod("debug"),this.page=this._createMethod("page"),this.once=this._createChainableMethod("once"),this.off=this._createChainableMethod("off"),this.on=this._createChainableMethod("on"),this.addSourceMiddleware=this._createMethod("addSourceMiddleware"),this.setAnonymousId=this._createMethod("setAnonymousId"),this.addDestinationMiddleware=this._createMethod("addDestinationMiddleware"),this.screen=this._createMethod("screen"),this.register=this._createMethod("register"),this.deregister=this._createMethod("deregister"),this.user=this._createMethod("user"),this.VERSION=Qn,this._preInitBuffer=new yo,this._promise=t(this._preInitBuffer),this._promise.then(function(t){var n=t[0],r=t[1];e.instance=n,e.ctx=r}).catch(function(){})}t.prototype.then=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=this._promise).then.apply(t,e)},t.prototype.catch=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=this._promise).catch.apply(t,e)},t.prototype.finally=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=this._promise).finally.apply(t,e)},t.prototype._createMethod=function(t){var e=this;return function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(e.instance){var i=(n=e.instance)[t].apply(n,r);return Promise.resolve(i)}return new Promise(function(n,o){e._preInitBuffer.add(new po(t,r,n,o))})}},t.prototype._createChainableMethod=function(t){var e=this;return function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e.instance?((n=e.instance)[t].apply(n,r),e):(e._preInitBuffer.add(new po(t,r)),e)}}}();var vo=o(525),bo=function(t){function e(e,n){var r=t.call(this,e)||this;return r.retryTimeout=n,r.name="RateLimitError",r}return(0,Nn.C6)(e,t),e}(Error),mo=function(t){return(0,Nn.Cl)({"Content-Type":"text/plain"},"function"==typeof t?t():t)};function go(t){return(encodeURI(JSON.stringify(t)).split(/%..|./).length-1)/1024}function wo(t,e){var n,r,o,i,u,a=[],s=!1,c=null!==(n=null==e?void 0:e.size)&&void 0!==n?n:10,l=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:5e3,f=0;function p(n){var r;if(0!==n.length){var o=null===(r=n[0])||void 0===r?void 0:r.writeKey,i=n.map(function(t){var e=t;e.sentAt;return(0,Nn.Tt)(e,["sentAt"])});return Un("https://".concat(t,"/b"),{credentials:null==e?void 0:e.credentials,keepalive:(null==e?void 0:e.keepalive)||s,headers:mo(null==e?void 0:e.headers),method:"post",body:JSON.stringify({writeKey:o,batch:i,sentAt:(new Date).toISOString()}),priority:null==e?void 0:e.priority}).then(function(t){var e;if(t.status>=500)throw new Error("Bad response from server: ".concat(t.status));if(429===t.status){var n=null===(e=t.headers)||void 0===e?void 0:e.get("x-ratelimit-reset"),r="string"==typeof n?1e3*parseInt(n):l;throw new bo("Rate limit exceeded: ".concat(t.status),r)}})}}function d(t){var n;return void 0===t&&(t=1),(0,Nn.sH)(this,void 0,void 0,function(){var r;return(0,Nn.YH)(this,function(o){return a.length?(r=a,a=[],[2,null===(n=p(r))||void 0===n?void 0:n.catch(function(n){var o;ur.system().log("error","Error sending batch",n),t<=(null!==(o=null==e?void 0:e.maxRetries)&&void 0!==o?o:10)&&("RateLimitError"===n.name&&(f=n.retryTimeout),a.push.apply(a,r),a.map(function(e){if("_metadata"in e){var n=e;n._metadata=(0,Nn.Cl)((0,Nn.Cl)({},n._metadata),{retryCount:t})}}),y(t+1))})]):[2]})})}function y(t){void 0===t&&(t=1),o||(o=setTimeout(function(){o=void 0,d(t).catch(console.error)},f||l),f=0)}return i=function(t){if((s=t)&&a.length){var e=function(t){var e=[],n=0;return t.forEach(function(t){go(e[n])>=64&&n++,e[n]?e[n].push(t):e[n]=[t]}),e}(a).map(p);Promise.all(e).catch(console.error)}},u=!1,window.addEventListener("pagehide",function(){u||i(u=!0)}),document.addEventListener("visibilitychange",function(){if("hidden"==document.visibilityState){if(u)return;u=!0}else u=!1;i(u)}),{dispatch:function(t,n){return(0,Nn.sH)(this,void 0,void 0,function(){var t;return(0,Nn.YH)(this,function(r){return a.push(n),t=a.length>=c||function(t){return go(t)>=450}(a)||(null==e?void 0:e.keepalive)&&function(t){return go(t)>=54}(a),[2,t||s?d():y()]})})}}}function So(t,e,n,r,o){var i,u=t.user();delete e.options,e.writeKey=null==n?void 0:n.apiKey,e.userId=e.userId||u.id(),e.anonymousId=e.anonymousId||u.anonymousId(),e.sentAt=new Date;var a=t.queue.failedInitializations||[];a.length>0&&(e._metadata={failedInitializations:a}),null!=o&&(o.attempts>1&&(e._metadata=(0,Nn.Cl)((0,Nn.Cl)({},e._metadata),{retryCount:o.attempts})),o.attempts++);var s=[],c=[];for(var l in r){var f=r[l];"Segment.io"===l&&s.push(l),"bundled"===f.bundlingStatus&&s.push(l),"unbundled"===f.bundlingStatus&&c.push(l)}for(var p=0,d=(null==n?void 0:n.unbundledIntegrations)||[];p<d.length;p++){var y=d[p];c.includes(y)||c.push(y)}var h=null!==(i=null==n?void 0:n.maybeBundledConfigIds)&&void 0!==i?i:{},v=[];return s.sort().forEach(function(t){var e;(null!==(e=h[t])&&void 0!==e?e:[]).forEach(function(t){v.push(t)})}),!1!==(null==n?void 0:n.addBundledMetadata)&&(e._metadata=(0,Nn.Cl)((0,Nn.Cl)({},e._metadata),{bundled:s.sort(),unbundled:c.sort(),bundledIds:v})),e}function Oo(t,e){return(0,Nn.sH)(this,void 0,void 0,function(){var n,r=this;return(0,Nn.YH)(this,function(o){switch(o.label){case 0:return n=[],zn()?[2,e]:[4,(i=function(){return e.length>0&&!zn()},u=function(){return(0,Nn.sH)(r,void 0,void 0,function(){var r;return(0,Nn.YH)(this,function(o){switch(o.label){case 0:return(r=e.pop())?[4,Hr(r,t)]:[2];case 1:return o.sent()instanceof ur||n.push(r),[2]}})})},(0,Nn.sH)(void 0,void 0,void 0,function(){var t;return(0,Nn.YH)(this,function(e){return t=function(e){return(0,Nn.sH)(void 0,void 0,void 0,function(){var n;return(0,Nn.YH)(this,function(r){switch(r.label){case 0:return i(e)?(n=t,[4,u()]):[3,2];case 1:return[2,n.apply(void 0,[r.sent()])];case 2:return[2]}})})},[2,t(void 0)]})}))];case 1:return o.sent(),n.map(function(t){return e.pushWithBackoff(t)}),[2,e]}var i,u})})}function jo(t,e,n,r){var o=this;t||setTimeout(function(){return(0,Nn.sH)(o,void 0,void 0,function(){var t,o;return(0,Nn.YH)(this,function(i){switch(i.label){case 0:return t=!0,[4,Oo(n,e)];case 1:return o=i.sent(),t=!1,e.todo>0&&r(t,o,n,r),[2]}})})},5e3*Math.random())}var Po=function(t){return"Segment.io"===t.name};function ko(t,e,n){var r,o,i;window.addEventListener("pagehide",function(){s.push.apply(s,Array.from(c)),c.clear()});var u,a=null!==(r=null==e?void 0:e.apiKey)&&void 0!==r?r:"",s=t.options.disableClientPersistence?new Er(t.queue.queue.maxAttempts,[]):new Mr(t.queue.queue.maxAttempts,"".concat(a,":dest-Segment.io")),c=new Set,l=!1,f=null!==(o=null==e?void 0:e.apiHost)&&void 0!==o?o:er,p=null!==(i=null==e?void 0:e.protocol)&&void 0!==i?i:"https",d="".concat(p,"://").concat(f),y=null==e?void 0:e.deliveryStrategy,h=y&&"strategy"in y&&"batching"===y.strategy?wo(f,y.config):(u=null==y?void 0:y.config,{dispatch:function(t,e){return Un(t,{credentials:null==u?void 0:u.credentials,keepalive:null==u?void 0:u.keepalive,headers:mo(null==u?void 0:u.headers),method:"post",body:JSON.stringify(e),priority:null==u?void 0:u.priority}).then(function(t){var e;if(t.status>=500)throw new Error("Bad response from server: ".concat(t.status));if(429===t.status){var n=null===(e=t.headers)||void 0===e?void 0:e.get("x-ratelimit-reset"),r=n?1e3*parseInt(n):5e3;throw new bo("Rate limit exceeded: ".concat(t.status),r)}})}});function v(r){return(0,Nn.sH)(this,void 0,void 0,function(){var o,i;return(0,Nn.YH)(this,function(u){return zn()?(s.push(r),jo(l,s,b,jo),[2,r]):(c.add(r),o=r.event.type.charAt(0),i=(0,vo.W)(r.event).json(),"track"===r.event.type&&delete i.traits,"alias"===r.event.type&&(i=function(t,e){var n,r,o,i,u=t.user();return e.previousId=null!==(o=null!==(r=null!==(n=e.previousId)&&void 0!==n?n:e.from)&&void 0!==r?r:u.id())&&void 0!==o?o:u.anonymousId(),e.userId=null!==(i=e.userId)&&void 0!==i?i:e.to,delete e.from,delete e.to,e}(t,i)),s.getAttempts(r)>=s.maxAttempts?(c.delete(r),[2,r]):[2,h.dispatch("".concat(d,"/").concat(o),So(t,i,e,n,r)).then(function(){return r}).catch(function(t){if(r.log("error","Error sending event",t),"RateLimitError"===t.name){var e=t.retryTimeout;s.pushWithBackoff(r,e)}else s.pushWithBackoff(r);return jo(l,s,b,jo),r}).finally(function(){c.delete(r)})])})})}var b={metadata:{writeKey:a,apiHost:f,protocol:p},name:"Segment.io",type:"destination",version:"0.1.0",isLoaded:function(){return!0},load:function(){return Promise.resolve()},track:v,identify:v,page:v,alias:v,group:v,screen:v};return s.todo&&jo(l,s,b,jo),b}var xo="This is being deprecated and will be not be available in future releases of Analytics JS",_o=Jn(),Io=null==_o?void 0:_o.analytics;var Eo=function(){function t(t,e){var n;this.timeout=300,this._getSegmentPluginMetadata=function(){var t;return null===(t=e.plugins.find(Po))||void 0===t?void 0:t.metadata},this.writeKey=t.writeKey;this.cdnSettings=null!==(n=t.cdnSettings)&&void 0!==n?n:{integrations:{"Segment.io":{apiKey:""}}},this.cdnURL=t.cdnURL}return Object.defineProperty(t.prototype,"apiHost",{get:function(){var t,e;return null===(e=null===(t=this._getSegmentPluginMetadata)||void 0===t?void 0:t.call(this))||void 0===e?void 0:e.apiHost},enumerable:!1,configurable:!0}),t}();function To(){console.warn(xo)}var Co=function(t){function e(e,n,r,o,i){var u,a,s=this;(s=t.call(this)||this)._debug=!1,s.initialized=!1,s.user=function(){return s._user},s.init=s.initialize.bind(s),s.log=To,s.addIntegrationMiddleware=To,s.listeners=To,s.addEventListener=To,s.removeAllListeners=To,s.removeListener=To,s.removeEventListener=To,s.hasListeners=To,s.add=To,s.addIntegration=To;var c=null==n?void 0:n.cookie,l=null!==(u=null==n?void 0:n.disableClientPersistence)&&void 0!==u&&u;s.queue=null!=r?r:function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var r=e?10:1,o=n?new Er(r,[]):new Mr(r,t);return new Rr(o)}("".concat(e.writeKey,":event-queue"),null==n?void 0:n.retryQueue,l),s.settings=new Eo(e,s.queue);var f=null==n?void 0:n.storage;return s._universalStorage=s.createStore(l,f,c),s._user=null!=o?o:new oo((0,Nn.Cl)({persist:!l,storage:null==n?void 0:n.storage},null==n?void 0:n.user),c).load(),s._group=null!=i?i:new uo((0,Nn.Cl)({persist:!l,storage:null==n?void 0:n.storage},null==n?void 0:n.group),c).load(),s.eventFactory=new xr(s._user),s.integrations=null!==(a=null==n?void 0:n.integrations)&&void 0!==a?a:{},s.options=null!=n?n:{},Br(s),s}return(0,Nn.C6)(e,t),e.prototype.createStore=function(t,e,n){return t?new Yr([new Xr]):e&&qr(e)?new Yr(to(eo(e.stores,n))):new Yr(to([Kr.LocalStorage,{name:Kr.Cookie,settings:n},Kr.Memory]))},Object.defineProperty(e.prototype,"storage",{get:function(){return this._universalStorage},enumerable:!1,configurable:!0}),e.prototype.track=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n,r,o,i,u,a,s=this;return(0,Nn.YH)(this,function(c){return e=lo(t),n=Bn.apply(void 0,t),r=n[0],o=n[1],i=n[2],u=n[3],a=this.eventFactory.track(r,o,i,this.integrations,e),[2,this._dispatch(a,u).then(function(t){return s.emit("track",r,t.event.properties,t.event.options),t})]})})},e.prototype.page=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n,r,o,i,u,a,s,c=this;return(0,Nn.YH)(this,function(l){return e=lo(t),n=Kn.apply(void 0,t),r=n[0],o=n[1],i=n[2],u=n[3],a=n[4],s=this.eventFactory.page(r,o,i,u,this.integrations,e),[2,this._dispatch(s,a).then(function(t){return c.emit("page",r,o,t.event.properties,t.event.options),t})]})})},e.prototype.identify=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n,r,o,i,u,a,s=this;return(0,Nn.YH)(this,function(c){return e=lo(t),n=Zn(this._user).apply(void 0,t),r=n[0],o=n[1],i=n[2],u=n[3],this._user.identify(r,o),a=this.eventFactory.identify(this._user.id(),this._user.traits(),i,this.integrations,e),[2,this._dispatch(a,u).then(function(t){return s.emit("identify",t.event.userId,t.event.traits,t.event.options),t})]})})},e.prototype.group=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=lo(e);if(0===e.length)return this._group;var o=Zn(this._group).apply(void 0,e),i=o[0],u=o[1],a=o[2],s=o[3];this._group.identify(i,u);var c=this._group.id(),l=this._group.traits(),f=this.eventFactory.group(c,l,a,this.integrations,r);return this._dispatch(f,s).then(function(e){return t.emit("group",e.event.groupId,e.event.traits,e.event.options),e})},e.prototype.alias=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n,r,o,i,u,a,s=this;return(0,Nn.YH)(this,function(c){return e=lo(t),n=Yn.apply(void 0,t),r=n[0],o=n[1],i=n[2],u=n[3],a=this.eventFactory.alias(r,o,i,this.integrations,e),[2,this._dispatch(a,u).then(function(t){return s.emit("alias",r,o,t.event.options),t})]})})},e.prototype.screen=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n,r,o,i,u,a,s,c=this;return(0,Nn.YH)(this,function(l){return e=lo(t),n=Kn.apply(void 0,t),r=n[0],o=n[1],i=n[2],u=n[3],a=n[4],s=this.eventFactory.screen(r,o,i,u,this.integrations,e),[2,this._dispatch(s,a).then(function(t){return c.emit("screen",r,o,t.event.properties,t.event.options),t})]})})},e.prototype.trackClick=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n;return(0,Nn.YH)(this,function(r){switch(r.label){case 0:return[4,o.e(248).then(o.bind(o,554))];case 1:return e=r.sent(),[2,(n=e.link).call.apply(n,(0,Nn.fX)([this],t,!1))]}})})},e.prototype.trackLink=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n;return(0,Nn.YH)(this,function(r){switch(r.label){case 0:return[4,o.e(248).then(o.bind(o,554))];case 1:return e=r.sent(),[2,(n=e.link).call.apply(n,(0,Nn.fX)([this],t,!1))]}})})},e.prototype.trackSubmit=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n;return(0,Nn.YH)(this,function(r){switch(r.label){case 0:return[4,o.e(248).then(o.bind(o,554))];case 1:return e=r.sent(),[2,(n=e.form).call.apply(n,(0,Nn.fX)([this],t,!1))]}})})},e.prototype.trackForm=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n;return(0,Nn.YH)(this,function(r){switch(r.label){case 0:return[4,o.e(248).then(o.bind(o,554))];case 1:return e=r.sent(),[2,(n=e.form).call.apply(n,(0,Nn.fX)([this],t,!1))]}})})},e.prototype.register=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n,r=this;return(0,Nn.YH)(this,function(o){switch(o.label){case 0:return e=ur.system(),n=t.map(function(t){return r.queue.register(e,t,r)}),[4,Promise.all(n)];case 1:return o.sent(),[2,e]}})})},e.prototype.deregister=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,Nn.sH)(this,void 0,void 0,function(){var e,n,r=this;return(0,Nn.YH)(this,function(o){switch(o.label){case 0:return e=ur.system(),n=t.map(function(t){var n=r.queue.plugins.find(function(e){return e.name===t});if(n)return r.queue.deregister(e,n,r);e.log("warn","plugin ".concat(t," not found"))}),[4,Promise.all(n)];case 1:return o.sent(),[2,e]}})})},e.prototype.debug=function(t){return!1===t&&localStorage.getItem("debug")&&localStorage.removeItem("debug"),this._debug=t,this},e.prototype.reset=function(){this._user.reset(),this._group.reset(),this.emit("reset")},e.prototype.timeout=function(t){this.settings.timeout=t},e.prototype._dispatch=function(t,e){return(0,Nn.sH)(this,void 0,void 0,function(){var n;return(0,Nn.YH)(this,function(r){return(n=new ur(t)).stats.increment("analytics_js.invoke",1,[t.type]),zn()&&!this.options.retryQueue?[2,n]:[2,sr(n,this.queue,this,{callback:e,debug:this._debug,timeout:this.settings.timeout})]})})},e.prototype.addSourceMiddleware=function(t){return(0,Nn.sH)(this,void 0,void 0,function(){var e=this;return(0,Nn.YH)(this,function(n){switch(n.label){case 0:return[4,this.queue.criticalTasks.run(function(){return(0,Nn.sH)(e,void 0,void 0,function(){var e,n,r;return(0,Nn.YH)(this,function(i){switch(i.label){case 0:return[4,o.e(751).then(o.bind(o,425))];case 1:return e=i.sent().sourceMiddlewarePlugin,n={},this.queue.plugins.forEach(function(t){if("destination"===t.type)return n[t.name]=!0}),r=e(t,n),[4,this.register(r)];case 2:return i.sent(),[2]}})})})];case 1:return n.sent(),[2,this]}})})},e.prototype.addDestinationMiddleware=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return this.queue.plugins.filter(_r).forEach(function(n){"*"!==t&&n.name.toLowerCase()!==t.toLowerCase()||n.addMiddleware.apply(n,e)}),Promise.resolve(this)},e.prototype.setAnonymousId=function(t){return this._user.anonymousId(t)},e.prototype.queryString=function(t){return(0,Nn.sH)(this,void 0,void 0,function(){return(0,Nn.YH)(this,function(e){switch(e.label){case 0:return!1===this.options.useQueryString?[2,[]]:[4,o.e(538).then(o.bind(o,798))];case 1:return[2,(0,e.sent().queryString)(this,t)]}})})},e.prototype.use=function(t){return t(this),this},e.prototype.ready=function(t){return void 0===t&&(t=function(t){return t}),(0,Nn.sH)(this,void 0,void 0,function(){return(0,Nn.YH)(this,function(e){return[2,Promise.all(this.queue.plugins.map(function(t){return t.ready?t.ready():Promise.resolve()})).then(function(e){return t(e),e})]})})},e.prototype.noConflict=function(){var t;return console.warn(xo),t=null!=Io?Io:this,window[ao]=t,this},e.prototype.normalize=function(t){return console.warn(xo),this.eventFactory.normalize(t)},Object.defineProperty(e.prototype,"failedInitializations",{get:function(){return console.warn(xo),this.queue.failedInitializations},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"VERSION",{get:function(){return Qn},enumerable:!1,configurable:!0}),e.prototype.initialize=function(t,e){return(0,Nn.sH)(this,void 0,void 0,function(){return(0,Nn.YH)(this,function(t){return console.warn(xo),[2,Promise.resolve(this)]})})},e.prototype.pageview=function(t){return(0,Nn.sH)(this,void 0,void 0,function(){return(0,Nn.YH)(this,function(e){switch(e.label){case 0:return console.warn(xo),[4,this.page({path:t})];case 1:return e.sent(),[2,this]}})})},Object.defineProperty(e.prototype,"plugins",{get:function(){var t;return console.warn(xo),null!==(t=this._plugins)&&void 0!==t?t:{}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Integrations",{get:function(){return console.warn(xo),this.queue.plugins.filter(function(t){return"destination"===t.type}).reduce(function(t,e){var n="".concat(e.name.toLowerCase().replace(".","").split(" ").join("-"),"Integration"),r=window[n];if(!r)return t;var o=r.Integration;return o?(t[e.name]=o,t):(t[e.name]=r,t)},{})},enumerable:!1,configurable:!0}),e.prototype.push=function(t){var e=t.shift();e&&!this[e]||this[e].apply(this,t)},e}(cr);!function(t){function e(){var e=t.call(this,{writeKey:""},{disableClientPersistence:!0})||this;return e.initialized=!0,e}(0,Nn.C6)(e,t)}(Co);function Ao(t){return Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ao(t)}var Lo=function(t){var e=structuredClone(t);return"interaction"===e.type?"target"in e.data&&e.data.target&&"object"===Ao(e.data.target)&&("value"in e.data.target&&void 0!==e.data.target.value&&(e.data.target.value=Fo(e.data.target.value)),"checked"in e.data.target&&void 0!==e.data.target.checked&&(e.data.target.checked=Fo(e.data.target.checked)),"formData"in e.data.target&&(e.data.target.formData=Fo(e.data.target.formData)),"change"===e.data.eventType&&("change"in e.data&&(e.data.change=Fo(e.data.change)),"mutation"===e.data.listener&&("innerText"in e.data.target&&(e.data.target.innerText=Fo(e.data.target.innerText)),"textContent"in e.data.target&&(e.data.target.textContent=Fo(e.data.target.textContent)),"attributes"in e.data.target&&(e.data.target.attributes=Fo(e.data.target.attributes))),"contenteditable"===e.data.listener&&("textContent"in e.data.target&&(e.data.target.textContent=Fo(e.data.target.textContent)),"innerText"in e.data.target&&(e.data.target.innerText=Fo(e.data.target.innerText))))):"network"===e.type&&(e.data.body=Fo(e.data.body)),e};function Fo(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("object"===Ao(t)&&t){if(Array.isArray(t))return t.map(function(t){return Fo(t,r-1)});var o={};for(var i in t)o[i]=Fo(t[i],0===r?0:r-1);return o}return r<=0?"boolean"===(n=Ao(e=t))||(["number","bigint"].includes(n)?999:null==e?e:"XXX"):t}function Mo(t){return Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mo(t)}function Go(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Do(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Go(Object(n),!0).forEach(function(e){Xo(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Go(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ho(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return No(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(No(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,No(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,No(f,"constructor",c),No(c,"constructor",s),s.displayName="GeneratorFunction",No(c,o,"GeneratorFunction"),No(f),No(f,o,"Generator"),No(f,r,function(){return this}),No(f,"toString",function(){return"[object Generator]"}),(Ho=function(){return{w:i,m:p}})()}function No(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}No=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){No(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},No(t,e,n,r)}function Ro(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function Bo(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){Ro(i,r,o,u,a,"next",t)}function a(t){Ro(i,r,o,u,a,"throw",t)}u(void 0)})}}function Ko(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zo(r.key),r)}}function Zo(t,e,n){return e&&Ko(t.prototype,e),n&&Ko(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Yo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xo(t,e,n){return(e=zo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zo(t){var e=function(t,e){if("object"!=Mo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Mo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Mo(e)?e:e+""}var qo=Zo(function t(e){var n,r,o,i,u;Yo(this,t),Xo(this,"flushAt",void 0),Xo(this,"flushInterval",void 0),Xo(this,"apiHost",void 0),Xo(this,"shouldDisableSignalsRedaction",void 0),Xo(this,"shouldIngestSignals",void 0),Xo(this,"writeKey",void 0),this.flushAt=null!==(n=e.flushAt)&&void 0!==n?n:5,this.apiHost=null!==(r=e.apiHost)&&void 0!==r?r:"signals.segment.io/v1",this.flushInterval=null!==(o=e.flushInterval)&&void 0!==o?o:2e3,this.shouldDisableSignalsRedaction=null!==(i=e.shouldDisableSignalsRedaction)&&void 0!==i?i:function(){return!1},this.shouldIngestSignals=null!==(u=e.shouldIngestSignals)&&void 0!==u?u:function(){return!1}}),Wo=function(){return Zo(function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Yo(this,t),Xo(this,"settings",void 0),Xo(this,"analytics",void 0),Xo(this,"index",0),this.settings=new qo(n),this.analytics=this.createAnalyticsClient({writeKey:e})},[{key:"createAnalyticsClient",value:(e=Bo(Ho().m(function t(e){var n;return Ho().w(function(t){for(;;)switch(t.n){case 0:return n=new Co({writeKey:e.writeKey}),this.settings.writeKey=n.settings.writeKey,t.n=1,n.register(ko(n,{apiHost:this.settings.apiHost,apiKey:this.settings.writeKey,deliveryStrategy:{config:{size:this.settings.flushAt,timeout:this.settings.flushInterval},strategy:"batching"}}));case 1:return n.emit("initialize",e),n.on("track",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];v.debug.apply(v,["Track event from analytics client"].concat(e))}),t.a(2,n)}},t,this)})),function(t){return e.apply(this,arguments)})},{key:"sendTrackCall",value:(t=Bo(Ho().m(function t(e){var n,r,o;return Ho().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.analytics;case 1:if(n=t.v,this.settings.shouldIngestSignals()){t.n=2;break}return t.a(2);case 2:return r=this.settings.shouldDisableSignalsRedaction(),o=r?e:Lo(e),r&&v.debug("Sending unredacted data to segment",o),t.a(2,n.track("Segment Signal Generated",Do(Do({},o),{},{index:this.index++})))}},t,this)})),function(e){return t.apply(this,arguments)})},{key:"send",value:function(t){return this.sendTrackCall(t)}}]);var t,e}();function Vo(t){return Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(t)}function Jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qo(r.key),r)}}function Uo(t,e,n){return(e=Qo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qo(t){var e=function(t,e){if("object"!=Vo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Vo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Vo(e)?e:e+""}var $o=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Uo(this,"client",void 0),Uo(this,"ctx",void 0)},(e=[{key:"load",value:function(t){this.ctx=t,this.client=new Wo(t.analyticsInstance.settings.writeKey,t.unstableGlobalSettings.ingestClient)}},{key:"process",value:function(t){this.client.send(t)}}])&&Jo(t.prototype,e),n&&Jo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ti(t){return ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ti(t)}function ei(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ni(r.key),r)}}function ni(t){var e=function(t,e){if("object"!=ti(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ti(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ti(e)?e:e+""}var ri=function(){return t=function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,r=void 0,(n=ni(n="user"))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r},(e=[{key:"load",value:function(t){this.user=t.analyticsInstance.user()}},{key:"process",value:function(t){return t.anonymousId=this.user.anonymousId(),t}}])&&ei(t.prototype,e),n&&ei(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}(),oi=function(t){return t.replace(/[\r\n\t]+/g," ").replace(/\s\s+/g," ").replace(/\u00A0/g," ").trim()};function ii(t){return ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ii(t)}function ui(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function ai(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ui(Object(n),!0).forEach(function(e){si(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ui(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function si(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=ii(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ii(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ii(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ci(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],s=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(t,e)||fi(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function li(t){return function(t){if(Array.isArray(t))return pi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||fi(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fi(t,e){if(t){if("string"==typeof t)return pi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pi(t,e):void 0}}function pi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var di=function(t){var e=t.textContent?oi(t.textContent):"";return{id:t.id,attributes:yi(t.attributes),textContent:e}},yi=function(t){return Array.from(t).reduce(function(t,e){return"string"!=typeof e.value&&null!==e.value||(t[e.name]=e.value),t},{})},hi=function(t,e){var n,r=t.getAttribute(e);if(r)return null!==(n=document.getElementById(r))&&void 0!==n?n:void 0},vi=function(t){var e,n,r,o=function(t){return t?li(t).map(di).filter(function(t){return Boolean(t)}):[]}(t.labels),i=hi(t,"aria-labelledby"),u=hi(t,"aria-describedby");if(i){var a=di(i);o.unshift(a)}var s,c=function(e){if(e in t){var n=t[e];return"string"==typeof n?n:void 0}},l={attributes:yi(t.attributes),classList:li(t.classList),id:c("id")||"",labels:o,label:o[0],name:c("name"),nodeName:t.nodeName,tagName:t.tagName,title:c("title")||"",type:c("type"),value:c("value"),textContent:null!==(e=t.textContent&&oi(t.textContent))&&void 0!==e?e:void 0,innerText:null!==(n=t.innerText&&oi(t.innerText))&&void 0!==n?n:void 0,describedBy:null!==(r=u&&di(u))&&void 0!==r?r:void 0};return t instanceof HTMLSelectElement?ai(ai({},l),{},{selectedOptions:li(t.selectedOptions).map(function(t){return{value:t.value,label:t.label}}),selectedIndex:t.selectedIndex}):t instanceof HTMLInputElement?ai(ai({},l),{},{checked:t.checked}):t instanceof HTMLMediaElement?ai(ai({},l),{},{currentSrc:t.currentSrc,currentTime:t.currentTime,duration:t.duration,ended:t.ended,muted:t.muted,paused:t.paused,playbackRate:t.playbackRate,readyState:t.readyState,src:t.src,volume:t.volume}):t instanceof HTMLFormElement?ai(ai({},l),{},{innerText:void 0,textContent:void 0,formData:(s=new FormData(t),li(s).reduce(function(t,e){var n=ci(e,2),r=n[0],o=n[1];return"string"==typeof o&&(t[r]=o),t},{}))}):l};function bi(t){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bi(t)}function mi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Oi(r.key),r)}}function wi(t,e,n){return e&&gi(t.prototype,e),n&&gi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Si(t,e,n){return(e=Oi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oi(t){var e=function(t,e){if("object"!=bi(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=bi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==bi(e)?e:e+""}var ji=function(){return wi(function t(){mi(this,t),Si(this,"id","click")},[{key:"register",value:function(t){var e=this,n=function(n){var r=n.target;if(r){var o=e.getClosestClickableElement(r);o&&t.emit(O({eventType:"click",target:vi(o)}))}};return document.addEventListener("click",n,!0),function(){return document.removeEventListener("click",n)}}},{key:"getClosestClickableElement",value:function(t){var e=["button","a","option",'[role="button"]','[role="link"]','[role="menuitem"]','[role="menuitemcheckbox"]','[role="menuitemradio"]','[role="tab"]','[role="option"]','[role="switch"]','[role="treeitem"]'].join(", ");return t.closest(e)}}])}(),Pi=function(){return wi(function t(){mi(this,t),Si(this,"id","form-submit")},[{key:"register",value:function(t){var e=function(e){var n=e.target;if(n){var r=e.submitter;t.emit(O({eventType:"submit",target:vi(n),submitter:r?vi(r):void 0}))}};return document.addEventListener("submit",e,!0),function(){return document.removeEventListener("submit",e)}}}])}(),ki=function(t){return t instanceof HTMLInputElement&&"password"===t.type};function xi(t){return xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xi(t)}var _i=function(t){return null!=t&&void 0!==t};function Ii(t){return Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ii(t)}function Ei(t,e,n){return e=Ci(e),function(t,e){if(e&&("object"==Ii(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ti()?Reflect.construct(e,n||[],Ci(t).constructor):e.apply(t,n))}function Ti(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ti=function(){return!!t})()}function Ci(t){return Ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ci(t)}function Ai(t,e){return Ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ai(t,e)}function Li(t){return function(t){if(Array.isArray(t))return Fi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Fi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fi(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Mi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Gi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mi(Object(n),!0).forEach(function(e){Ri(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mi(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Di(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Bi(r.key),r)}}function Hi(t,e,n){return e&&Di(t.prototype,e),n&&Di(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ni(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ri(t,e,n){return(e=Bi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bi(t){var e=function(t,e){if("object"!=Ii(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ii(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ii(e)?e:e+""}var Ki=["aria-pressed","aria-checked","aria-modal","aria-selected","value","checked","data-selected"],Zi=["input","label","option","select","textarea"],Yi=["button","checkbox","dialog","gridcell","row","searchbox","menuitemcheckbox","menuitemradio","option","radio","scrollbar","slider","spinbutton","switch","tab","treeitem"],Xi=Hi(function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ni(this,t),Ri(this,"pollIntervalMs",void 0),Ri(this,"debounceMs",void 0),Ri(this,"emitInputStrategy",void 0),Ri(this,"extraSelectors",void 0),Ri(this,"observedRoles",void 0),Ri(this,"observedTags",void 0),Ri(this,"observedAttributes",void 0);var n=e.pollIntervalMs,r=void 0===n?400:n,o=e.debounceMs,i=void 0===o?1e3:o,u=e.emitInputStrategy,a=void 0===u?"debounce-only":u,s=e.extraSelectors,c=void 0===s?[]:s,l=e.observedRoles,f=e.observedTags,p=e.observedAttributes;if(r<300)throw new Error("Poll interval must be at least 300ms");this.emitInputStrategy=a,this.pollIntervalMs=r,this.debounceMs=i,this.extraSelectors=c,this.observedRoles=l?l(Yi):Yi,this.observedTags=f?f(Zi):Zi,this.observedAttributes=p?p(Ki):Ki}),zi=function(){return Hi(function t(e){var n=this;Ni(this,t),Ri(this,"settings",void 0),Ri(this,"observedElements",new WeakSet),Ri(this,"prevMutationsCache",new WeakMap),Ri(this,"emitter",new Wi),Ri(this,"listeners",new Set),Ri(this,"pollTimeout",void 0),Ri(this,"experimentalOnChangeAdapter",new qi),this.settings=null!=e?e:new Xi,this.checkForNewElements(this.emitter),this.pollTimeout=setInterval(function(){return n.checkForNewElements(n.emitter)},this.settings.pollIntervalMs)},[{key:"subscribe",value:function(t){this.listeners.add(t),this.emitter.on("attributeChanged",t)}},{key:"cleanup",value:function(){var t=this;this.listeners.forEach(function(e){return t.emitter.off("attributeChanged",e)}),this.listeners.clear(),clearInterval(this.pollTimeout)}},{key:"shouldEmitEvent",value:function(t,e){return"aria-selected"!==t||"false"!==e}},{key:"observeElementAttributes",value:function(t,e,n){var r=this;if(t instanceof HTMLElement){var o,i,u,a,s=function(e){n.emit("attributeChanged",{element:t,attributes:e})},c="blur"===this.settings.emitInputStrategy?function(e){return r.experimentalOnChangeAdapter.onBlur(t,function(){return s(e)})}:s,l=function(t){var e=new Set(["text","password","email","url","tel","number","search","date","time","datetime-local","month","week","color","range",null]),n=new Set(["spinbutton"]),r=t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement;if(t.isContentEditable)return!0;if(!r)return!1;var o=t.getAttribute("type");if(e.has(o))return!0;var i=t.getAttribute("role");return!(!i||!n.has(i))}(t)?(o=c,i=function(t){return Object.keys(t).sort()},u=this.settings.debounceMs,a=new Map,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=i.apply(void 0,e),s="object"===xi(r)?JSON.stringify(r):r;a.has(s)&&clearTimeout(a.get(s));var c=setTimeout(function(){a.delete(s),o.apply(void 0,e)},u);a.set(s,c)}):s;new MutationObserver(function(e){var n=e.filter(function(t){return"attributes"===t.type}).map(function(t){var e=t.attributeName,n=t.target;if(e&&n&&n instanceof HTMLElement){var r=n.getAttribute(e),o={attributeName:e,newValue:r};return v.debug("Attribute mutation",{newValue:r,oldValue:t.oldValue,target:t.target}),o}}).filter(_i).filter(function(t){return r.shouldEmitEvent(t.attributeName,t.newValue)}).reduce(function(t,e){return t[e.attributeName]=e.newValue,t},{});if(!(0===Object.keys(n).length)){var o,i,u=r.prevMutationsCache.get(t);if(u)if(!(o=n,i=u,!Object.keys(o).every(function(t){return o[t]===i[t]})))return;r.prevMutationsCache.set(t,Gi(Gi({},u),n)),l(n)}}).observe(t,{attributes:!0,attributeFilter:e,subtree:!1}),this.observedElements.add(t)}}},{key:"checkForNewElements",value:function(t){var e=this;[].concat(Li(this.settings.observedRoles.map(function(t){return'[role="'.concat(t,'"]')})),Li(this.settings.observedTags),Li(this.settings.extraSelectors)).forEach(function(n){document.querySelectorAll(n).forEach(function(n){e.observedElements.has(n)||(v.debug("Observing element",n),e.observeElementAttributes(n,e.settings.observedAttributes,t))})})}}])}(),qi=function(){return Hi(function t(){Ni(this,t),Ri(this,"inputListeners",new Map)},[{key:"removeListener",value:function(t){var e=this.inputListeners.get(t);e&&t.removeEventListener("blur",e)}},{key:"onBlur",value:function(t,e){this.removeListener(t),t.addEventListener("blur",e,{once:!0}),t.addEventListener("keydown",function(t){"Enter"===t.key&&e()},{once:!0}),this.inputListeners.set(t,e)}}])}(),Wi=function(t){function e(){return Ni(this,e),Ei(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ai(t,e)}(e,t),Hi(e)}(cr);function Vi(t){return Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vi(t)}function Ji(t,e,n){return(e=$i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ui(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$i(r.key),r)}}function Qi(t,e,n){return e&&Ui(t.prototype,e),n&&Ui(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $i(t){var e=function(t,e){if("object"!=Vi(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Vi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Vi(e)?e:e+""}function tu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eu(t,e,n){return e=ru(e),function(t,e){if(e&&("object"==Vi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,nu()?Reflect.construct(e,n||[],ru(t).constructor):e.apply(t,n))}function nu(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(nu=function(){return!!t})()}function ru(t){return ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ru(t)}function ou(t,e){return ou=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ou(t,e)}var iu=function(t){function e(){return tu(this,e),eu(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ou(t,e)}(e,t),Qi(e)}(Xi),uu=function(){return Qi(function t(e){tu(this,t),Ji(this,"id","mutation"),Ji(this,"elMutObserver",void 0),Ji(this,"customSelectors",[]),this.elMutObserver=new zi(e.mutationGenerator)},[{key:"register",value:function(t){var e=this;return this.elMutObserver.subscribe(function(e){var n=e.element;if(n&&!ki(n)){var r=vi(e.element);t.emit(O({eventType:"change",target:r,listener:"mutation",change:e.attributes}))}}),function(){return e.elMutObserver.cleanup()}}}])}(),au=function(){return Qi(function t(){tu(this,t),Ji(this,"id","change")},[{key:"register",value:function(t){var e=function(e){var n=e.target;if(n&&!ki(n))if(function(t){var e=t.getAttribute("type");return!(!(t instanceof HTMLInputElement)||null!==e&&!["text","password","email","url","tel","number","search","date","time","datetime-local","month","week","color","range"].includes(e))&&null!==t.getAttribute("value")}(n))v.debug("Ignoring onchange event in stateful element",n);else{var r=vi(n),o=function(t){if(t instanceof HTMLSelectElement)return{selectedOptions:Array.from(t.selectedOptions).map(function(t){return{value:t.value,label:t.label}})};if(t instanceof HTMLTextAreaElement)return{value:t.value};var e;if(t instanceof HTMLInputElement&&("value"in t||"checked"in t))return"checkbox"===t.type||"radio"===t.type?{checked:t.checked}:"file"===t.type?{files:Array.from(null!==(e=t.files)&&void 0!==e?e:[]).map(function(t){return t.name})}:{value:t.value}}(n);o?t.emit(O({eventType:"change",listener:"onchange",target:r,change:o})):v.debug("No change found on element..., this should not happen",r)}};return document.addEventListener("change",e,!0),function(){document.removeEventListener("change",e,!0)}}}])}(),su=function(){return Qi(function t(){tu(this,t),Ji(this,"id","contenteditable")},[{key:"register",value:function(t){var e=function(e){if(e.target instanceof HTMLElement){var n=e.target,r=vi(n);t.emit(O({eventType:"change",listener:"contenteditable",target:r,change:{textContent:r.textContent||null}}))}},n=function(t){var n=t.target;n instanceof HTMLElement&&n.isContentEditable&&n.addEventListener("blur",e,{once:!0})};return document.addEventListener("input",n,!0),function(){return document.removeEventListener("input",n)}}}])}();function cu(t){return cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(t)}function lu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pu(r.key),r)}}function fu(t,e,n){return(e=pu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pu(t){var e=function(t,e){if("object"!=cu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=cu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==cu(e)?e:e+""}var du=function(){return t=function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),fu(this,"emitter",new cr),fu(this,"pollInterval",void 0),fu(this,"urlChanged",void 0),this.pollInterval=null!==(e=n.pollInterval)&&void 0!==e?e:500,this.pollURLChange()},(e=[{key:"pollURLChange",value:function(){var t=this,e=window.location.href;setInterval(function(){var n=window.location.href;if(n!=e){var r=new URL(n),o=new URL(e);t.emitter.emit("change",{current:r,previous:o}),e=n}},this.pollInterval)}},{key:"subscribe",value:function(t){this.urlChanged=t,this.emitter.on("change",this.urlChanged)}},{key:"unsubscribe",value:function(){this.emitter.off("change",this.urlChanged)}}])&&lu(t.prototype,e),n&&lu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function yu(t){return yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(t)}function hu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function vu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hu(Object(n),!0).forEach(function(e){mu(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hu(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function bu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gu(r.key),r)}}function mu(t,e,n){return(e=gu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gu(t){var e=function(t,e){if("object"!=yu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=yu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yu(e)?e:e+""}function wu(t,e){for(var n=[],r=0,o=["pathname","search","hash"];r<o.length;r++){var i=o[r];t[i]!==e[i]&&("pathname"===i?n.push("path"):n.push(i))}return n}var Su,Ou=[uu,au,su,ji,Pi,function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),mu(this,"id","navigation"),mu(this,"urlChange",void 0),this.urlChange=new du},(e=[{key:"register",value:function(t){var e=this;return t.emit(j(vu({},this.createCommonFields()))),this.urlChange.subscribe(function(n){var r=n.previous,o=n.current;return t.emit(j(vu({previousUrl:r.href,changedProperties:wu(o,r)},e.createCommonFields())))}),function(){e.urlChange.unsubscribe()}}},{key:"createCommonFields",value:function(){return{currentUrl:location.href,path:location.pathname,hash:location.hash,search:location.search,title:document.title}}}])&&bu(t.prototype,e),n&&bu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}()];function ju(t){return ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(t)}function Pu(t,e,n){return e=Iu(e),function(t,e){if(e&&("object"==ju(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ku()?Reflect.construct(e,n||[],Iu(t).constructor):e.apply(t,n))}function ku(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ku=function(){return!!t})()}function xu(t,e,n,r){var o=_u(Iu(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof o?function(t){return o.apply(n,t)}:o}function _u(){return _u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Iu(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_u.apply(null,arguments)}function Iu(t){return Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Iu(t)}function Eu(t,e){return Eu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Eu(t,e)}function Tu(t,e,n){return(e=Hu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cu(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return Au(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Au(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Au(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Au(f,"constructor",c),Au(c,"constructor",s),s.displayName="GeneratorFunction",Au(c,o,"GeneratorFunction"),Au(f),Au(f,o,"Generator"),Au(f,r,function(){return this}),Au(f,"toString",function(){return"[object Generator]"}),(Cu=function(){return{w:i,m:p}})()}function Au(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Au=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){Au(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},Au(t,e,n,r)}function Lu(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function Fu(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){Lu(i,r,o,u,a,"next",t)}function a(t){Lu(i,r,o,u,a,"throw",t)}u(void 0)})}}function Mu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hu(r.key),r)}}function Du(t,e,n){return e&&Gu(t.prototype,e),n&&Gu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hu(t){var e=function(t,e){if("object"!=ju(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ju(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ju(e)?e:e+""}var Nu=function(t){return t.toUpperCase()},Ru=function(t){var e,n=t.url,r=t.body,o=t.headers,i=t.id,u=t.method;return{url:n.toString(),method:u,headers:null!=o?o:new Headers,contentType:null!==(e=null==o?void 0:o.get("content-type"))&&void 0!==e?e:void 0,body:"string"==typeof r?r:void 0,id:i}},Bu=function(t){var e=t.body,n=t.headers,r=t.initiator,o=t.status,i=t.statusText,u=t.url,a=t.responseType,s=t.id;return{body:e,headers:n,initiator:r,ok:On(o),status:o,statusText:i,url:u,responseType:a,req:{id:s}}},Ku=function(){return Du(function t(){Mu(this,t)},[{key:"addInterceptors",value:function(t,e){this.addFetchInterceptor(t,e),this.addXhrInterceptor(t,e)}},{key:"addFetchInterceptor",value:function(t,e){window.fetch&&(Su=window.fetch,window.fetch=Fu(Cu().m(function n(){var r,o,i,u,a,s,c,l,f,p,d,y=arguments;return Cu().w(function(n){for(;;)switch(n.n){case 0:for(r=y.length,o=new Array(r),i=0;i<r;i++)o[i]=y[i];u=o[0],a=o[1],s=kn();try{c=Pn(u),l=null!=a&&a.headers?gn(a.headers):void 0,t(Ru({url:c,body:"string"==typeof(null==a?void 0:a.body)?a.body:void 0,method:null!=a&&a.method?Nu(a.method):"GET",headers:l,id:s}))}catch(t){console.log("Error handling request: ",t)}return n.n=1,Su.apply(void 0,o);case 1:f=n.v,p=f.clone();try{d=function(){var t=Fu(Cu().m(function t(){var e,n;return Cu().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,p.text();case 1:e=t.v,t.n=3;break;case 2:return t.p=2,n=t.v,console.warn("Error converting to text",n,p),t.a(2,null);case 3:return t.a(2,jn(e))}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),e(Bu({body:d,headers:p.headers,initiator:"fetch",status:p.status,statusText:p.statusText,url:p.url,responseType:void 0,id:s}))}catch(t){console.log("Error handling response: ",t)}return n.a(2,f)}},n)})))}},{key:"addXhrInterceptor",value:function(t,e){if(window.XMLHttpRequest){var n=function(n){function r(){var n;return Mu(this,r),Tu(n=Pu(this,r),"_reqURL",void 0),Tu(n,"_reqMethod",void 0),Tu(n,"_reqBody",void 0),Tu(n,"_reqHeaders",void 0),Tu(n,"_reqId",kn()),n.addEventListener("readystatechange",function(){if(n.readyState===n.HEADERS_RECEIVED)try{t(Ru({url:n._reqURL,method:n._reqMethod,headers:n._reqHeaders,id:n._reqId,body:n._reqBody?n._reqBody.toString():void 0}))}catch(t){console.log("Error handling request",t)}if(n.readyState===n.DONE)try{e(Bu({status:n.status,responseType:n.responseType,statusText:n.statusText,url:n.responseURL,initiator:"xhr",body:function(){return Promise.resolve(n.getParsedXHRBody())},headers:n.getParsedXHRHeaders(n.getAllResponseHeaders()),id:n._reqId}))}catch(t){console.log("Error handling response",t)}}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Eu(t,e)}(r,n),Du(r,[{key:"getParsedXHRHeaders",value:function(t){var e=new Headers;return t.trim().split(/[\r\n]+/).forEach(function(t){var n=t.split(": "),r=n.shift(),o=n.join(": ");r&&e.append(r,o)}),e}},{key:"getParsedXHRBody",value:function(){return"json"===this.responseType?this.response:"string"==typeof this.response?jn(this.response):null}},{key:"open",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e[0],i=e[1];try{this._reqURL=i.toString(),this._reqMethod=Nu(o)}catch(t){console.log("Error handling request (open)",t)}xu(r,"open",this,3)(e)}},{key:"send",value:function(t){this._reqBody=t,xu(r,"send",this,3)([t])}},{key:"setRequestHeader",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];try{var o=e[0],i=e[1];this._reqHeaders||(this._reqHeaders=new Headers),this._reqHeaders.append(o,i)}catch(t){console.log("Error handling request (setRequestHeader)",t)}xu(r,"setRequestHeader",this,3)(e)}}])}(window.XMLHttpRequest);window.XMLHttpRequest=n}}},{key:"cleanup",value:function(){Su&&(window.fetch=Su)}}])}();function Zu(t){return Zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(t)}function Yu(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return Xu(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Xu(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Xu(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Xu(f,"constructor",c),Xu(c,"constructor",s),s.displayName="GeneratorFunction",Xu(c,o,"GeneratorFunction"),Xu(f),Xu(f,o,"Generator"),Xu(f,r,function(){return this}),Xu(f,"toString",function(){return"[object Generator]"}),(Yu=function(){return{w:i,m:p}})()}function Xu(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Xu=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){Xu(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},Xu(t,e,n,r)}function zu(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function qu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vu(r.key),r)}}function Wu(t,e,n){return(e=Vu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vu(t){var e=function(t,e){if("object"!=Zu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Zu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Zu(e)?e:e+""}var Ju=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Wu(this,"id","network"),Wu(this,"interceptor",new Ku),Wu(this,"emittedRequestIds",[])},e=[{key:"register",value:function(t){var e=this,n=function(){var n,r=(n=Yu().m(function n(r){var o,i,u,a;return Yu().w(function(n){for(;;)switch(n.n){case 0:if(o=r.ok&&"json"!==r.responseType&&!Sn(r.headers),i=!r.ok&&!e.emittedRequestIds.includes(r.req.id),!o&&!i){n.n=1;break}return n.a(2);case 1:if(u=r.url){n.n=2;break}return n.a(2);case 2:return n.n=3,r.body();case 3:a=n.v,t.emit(P({action:"response",url:u,body:a,ok:r.ok,status:r.status,contentType:r.headers.get("content-type")||"",requestId:r.req.id}));case 4:return n.a(2)}},n)}),function(){var t=this,e=arguments;return new Promise(function(r,o){var i=n.apply(t,e);function u(t){zu(i,r,o,u,a,"next",t)}function a(t){zu(i,r,o,u,a,"throw",t)}u(void 0)})});return function(t){return r.apply(this,arguments)}}();return this.interceptor.addInterceptors(function(n){var r;if(n.url){var o="string"==typeof n.body?jn(n.body):null;e.emittedRequestIds.push(n.id),t.emit(P({action:"request",url:n.url,method:n.method||"GET",body:o,contentType:(null===(r=n.headers)||void 0===r?void 0:r.get("content-type"))||"",requestId:n.id}))}},n),function(){e.interceptor.cleanup(),v.debug("Removing fetch interceptor")}}}],e&&qu(t.prototype,e),n&&qu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function Uu(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return Qu(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Qu(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Qu(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Qu(f,"constructor",c),Qu(c,"constructor",s),s.displayName="GeneratorFunction",Qu(c,o,"GeneratorFunction"),Qu(f),Qu(f,o,"Generator"),Qu(f,r,function(){return this}),Qu(f,"toString",function(){return"[object Generator]"}),(Uu=function(){return{w:i,m:p}})()}function Qu(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Qu=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){Qu(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},Qu(t,e,n,r)}function $u(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}var ta=function(){var t,e=(t=Uu().m(function t(e,n,r){var o,i;return Uu().w(function(t){for(;;)switch(t.n){case 0:return o=function(t){return v.debug("Registering generator:",t.id||t.name),"function"==typeof(n=t)&&void 0!==n.prototype.constructor?new t(r).register(e):t.register(e);var n},t.n=1,Promise.all(n.map(o));case 1:return i=t.v,t.a(2,function(){return i.forEach(function(t){return t()})})}},t)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){$u(i,r,o,u,a,"next",t)}function a(t){$u(i,r,o,u,a,"throw",t)}u(void 0)})});return function(t,n,r){return e.apply(this,arguments)}}();function ea(t){return ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ea(t)}function na(t){return function(t){if(Array.isArray(t))return ra(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ra(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ra(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ra(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function oa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ia(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,sa(r.key),r)}}function ua(t,e,n){return e&&ia(t.prototype,e),n&&ia(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function aa(t,e,n){return(e=sa(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sa(t){var e=function(t,e){if("object"!=ea(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ea(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ea(e)?e:e+""}var ca=function(){return ua(function t(e){var n,r=this;if(oa(this,t),aa(this,"sandbox",void 0),aa(this,"signalBuffer",void 0),aa(this,"ingestClient",void 0),aa(this,"network",void 0),aa(this,"signalsDebug",void 0),aa(this,"mutationGenerator",void 0),aa(this,"sampleSuccess",!1),e.maxBufferSize&&e.signalStorage)throw new Error("maxBufferSize and signalStorage cannot be defined at the same time");this.mutationGenerator=new iu({extraSelectors:e.mutationGenExtraSelectors,observedRoles:e.mutationGenObservedRoles,observedTags:e.mutationGenObservedTags,pollIntervalMs:e.mutationGenPollInterval,observedAttributes:e.mutationGenObservedAttributes}),this.signalsDebug=new la(e.disableSignalsRedaction,e.enableSignalsIngestion),this.signalBuffer={signalStorage:e.signalStorage,storageType:e.signalStorageType,maxBufferSize:e.maxBufferSize},this.ingestClient={apiHost:e.apiHost,flushAt:e.flushAt,flushInterval:e.flushInterval,shouldDisableSignalsRedaction:this.signalsDebug.getDisableSignalsRedaction,shouldIngestSignals:function(){return!!r.signalsDebug.getEnableSignalsIngestion()||!!r.sampleSuccess}},this.sandbox={sandboxStrategy:null!==(n=e.sandboxStrategy)&&void 0!==n?n:"iframe",functionHost:e.functionHost,processSignal:e.processSignal,edgeFnDownloadURL:void 0},this.network=new Fn({networkSignalsAllowList:e.networkSignalsAllowList,networkSignalsDisallowList:e.networkSignalsDisallowList,networkSignalsAllowSameDomain:e.networkSignalsAllowSameDomain})},[{key:"update",value:function(t){var e,n=t.edgeFnDownloadURL,r=t.disallowListURLs,o=t.sampleRate;n&&(this.sandbox.edgeFnDownloadURL=n),(e=this.network.networkSignalsFilterList.disallowed).addURLLike.apply(e,na(r.filter(function(t){return Boolean(t)}))),this.sampleSuccess=this.checkSampleRate(null!=o?o:0)}},{key:"checkSampleRate",value:function(t){var e=new s(window.sessionStorage),n=e.getItem("segment_sample_success");return void 0!==n?n:t&&Math.random()<=t?(e.setItem("segment_sample_success",!0),!0):(e.setItem("segment_sample_success",!1),!1)}}])}(),la=ua(function e(n,r){var o=this;oa(this,e),aa(this,"storage",new s(window.sessionStorage)),aa(this,"setAllDebugging",function(t){o.storage.setItem(e.redactionKey,t),o.storage.setItem(e.ingestionKey,t)}),aa(this,"getDisableSignalsRedaction",function(){var t;return null!==(t=o.storage.getItem(e.redactionKey))&&void 0!==t&&t}),aa(this,"getEnableSignalsIngestion",function(){var t;return null!==(t=o.storage.getItem(e.ingestionKey))&&void 0!==t&&t}),"boolean"==typeof n&&this.storage.setItem(e.redactionKey,n),"boolean"==typeof r&&this.storage.setItem(e.ingestionKey,r);var i=t();v.debug("debugMode is set to true via query string"),"boolean"==typeof i&&this.setAllDebugging(i)});function fa(t){return fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fa(t)}function pa(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return da(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(da(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,da(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,da(f,"constructor",c),da(c,"constructor",s),s.displayName="GeneratorFunction",da(c,o,"GeneratorFunction"),da(f),da(f,o,"Generator"),da(f,r,function(){return this}),da(f,"toString",function(){return"[object Generator]"}),(pa=function(){return{w:i,m:p}})()}function da(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}da=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){da(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},da(t,e,n,r)}function ya(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function ha(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){ya(i,r,o,u,a,"next",t)}function a(t){ya(i,r,o,u,a,"throw",t)}u(void 0)})}}function va(t){return function(t){if(Array.isArray(t))return ba(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ba(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ba(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ba(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ma(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wa(r.key),r)}}function ga(t,e,n){return(e=wa(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wa(t){var e=function(t,e){if("object"!=fa(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=fa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==fa(e)?e:e+""}aa(la,"redactionKey","segment_signals_debug_redaction_disabled"),aa(la,"ingestionKey","segment_signals_debug_ingestion_enabled");var Sa=function(){return t=function t(){var e,n,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ga(this,"buffer",void 0),ga(this,"signalEmitter",void 0),ga(this,"cleanup",[]),ga(this,"globalSettings",void 0),this.globalSettings=new ca(o),o.debug&&this.debug(),this.buffer=(e=this.globalSettings.signalBuffer,r=(null!==(n=e.signalStorage)&&void 0!==n?n:"session"===e.storageType)?new kt(e):new Pt(e),new xt(r)),this.signalEmitter=this.getSignalEmitter(o.middleware),this.registerGenerator([].concat(va(Ou),[new Ju]))},e=[{key:"start",value:(o=ha(pa().m(function t(e){var n,r,o,i,u=this;return pa().w(function(t){for(;;)switch(t.n){case 0:return(i=new A(e)).instance.on("reset",function(){u.clearStorage()}),this.globalSettings.update({edgeFnDownloadURL:null===(n=i.edgeFnSettings)||void 0===n?void 0:n.downloadURL,disallowListURLs:[i.instance.settings.apiHost,i.instance.settings.cdnURL],sampleRate:null!==(r=null===(o=i.instance.settings.cdnSettings.autoInstrumentationSettings)||void 0===o?void 0:o.sampleRate)&&void 0!==r?r:0}),t.n=1,this.registerGenerator([i.createSegmentInstrumentationEventGenerator()]);case 1:this.signalEmitter.start({unstableGlobalSettings:this.globalSettings,analyticsInstance:i.instance,buffer:this.buffer});case 2:return t.a(2)}},t,this)})),function(t){return o.apply(this,arguments)})},{key:"stop",value:function(){this.cleanup.forEach(function(t){return t()})}},{key:"clearStorage",value:function(){this.buffer.clear()}},{key:"debug",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.globalSettings.signalsDebug.setAllDebugging(t),v.enableLogging(null!=e?e:"info")}},{key:"registerGenerator",value:(r=ha(pa().m(function t(e){var n,r;return pa().w(function(t){for(;;)switch(t.n){case 0:if(this.signalEmitter){t.n=1;break}throw new Error("SignalEmitter not initialized");case 1:if(this.globalSettings){t.n=2;break}throw new Error("GlobalSettings not initialized");case 2:return n=this.cleanup,t.n=3,ta(this.signalEmitter,e,this.globalSettings);case 3:r=t.v,n.push.call(n,r);case 4:return t.a(2)}},t,this)})),function(t){return r.apply(this,arguments)})},{key:"getSignalEmitter",value:function(t){var e,n=this;return(e=new Zt).addMiddleware.apply(e,[new ri,new Hn].concat(va(t||[]))).subscribe(function(t){return v.logSignal(t)},function(t){return n.buffer.add(t)},new $o,new bn)}}],e&&ma(t.prototype,e),n&&ma(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}(),Oa="2.1.0";function ja(t){return ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ja(t)}function Pa(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof a?r:a,c=Object.create(s.prototype);return ka(c,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,s=t,p.n=n,u}};function d(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,s)):p.n=s:p.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var u={};function a(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ka(e={},r,function(){return this}),e),f=c.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,ka(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,ka(f,"constructor",c),ka(c,"constructor",s),s.displayName="GeneratorFunction",ka(c,o,"GeneratorFunction"),ka(f),ka(f,o,"Generator"),ka(f,r,function(){return this}),ka(f,"toString",function(){return"[object Generator]"}),(Pa=function(){return{w:i,m:p}})()}function ka(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ka=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){ka(t,e,function(t){return this._invoke(e,n,t)})}i("next",0),i("throw",1),i("return",2)}},ka(t,e,n,r)}function xa(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function _a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ia(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_a(Object(n),!0).forEach(function(e){Ta(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_a(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ea(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ca(r.key),r)}}function Ta(t,e,n){return(e=Ca(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ca(t){var e=function(t,e){if("object"!=ja(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ja(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ja(e)?e:e+""}var Aa=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ta(this,"type","utility"),Ta(this,"name","SignalsPlugin"),Ta(this,"version",Oa),Ta(this,"signals",void 0),function(){if("undefined"==typeof window)throw new Error("This can only be run in a browser environment.")}(),Object.assign(window,{SegmentSignalsPlugin:this}),this.signals=new Sa(Ia(Ia({},e),{},{processSignal:"function"==typeof e.processSignal?e.processSignal.toString():e.processSignal})),v.debug("SignalsPlugin v".concat(Oa," initializing"),{settings:e})},e=[{key:"isLoaded",value:function(){return!0}},{key:"load",value:(r=Pa().m(function t(e,n){var r;return Pa().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.signals.start(n);case 1:v.debug("SignalsPlugin loaded"),t.n=3;break;case 2:t.p=2,r=t.v,console.error(r);case 3:return t.a(2)}},t,this,[[0,2]])}),o=function(){var t=this,e=arguments;return new Promise(function(n,o){var i=r.apply(t,e);function u(t){xa(i,n,o,u,a,"next",t)}function a(t){xa(i,n,o,u,a,"throw",t)}u(void 0)})},function(t,e){return o.apply(this,arguments)})},{key:"stop",value:function(){return this.signals.stop()}},{key:"onSignal",value:function(t){return this.signals.signalEmitter.subscribe(t),this}},{key:"addSignal",value:function(t){return this.signals.signalEmitter.emit(function(t){return S("userDefined",t)}(t)),this}},{key:"debug",value:function(){var t;return(t=this.signals).debug.apply(t,arguments),this}}],e&&Ea(t.prototype,e),n&&Ea(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}()}();var u=window;for(var a in i)u[a]=i[a];i.__esModule&&Object.defineProperty(u,"__esModule",{value:!0})}();
//# sourceMappingURL=analytics-signals.global.js.map